const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-BPXGE2oM.js","assets/index-Ch4hUogU.js","assets/index-BRHQdSq4.css"])))=>i.map(i=>d[i]);
import{r as D,j as f,g as Wt,a as _n,_ as Oe}from"./index-Ch4hUogU.js";import{m as R,A as te,g as ps,h as nt,i as wn,c as st,F as Me,j as Nt,k as ms,l as xn,n as Tn,o as gs,d as ys,a as vs,p as bs,q as _s,S as ws,H as xs,P as Ts,r as Ss,f as Es}from"./PageHeader-CJrKnbhg.js";function yr({label:n,icon:e,type:t,placeholder:r,value:s,onChange:i,error:a,min:o,max:l,required:u,onInvalid:c,id:h,name:p}){const d=e,[m,y]=D.useState(!1),g=h||`field-${n==null?void 0:n.replace(/\s+/g,"-").toLowerCase()}-${Math.random().toString(36).substr(2,9)}`;D.useEffect(()=>{const _=window.navigator.userAgent.toLowerCase();y(/iphone|ipad|ipod/.test(_))},[]);const v=()=>{const _=`w-full pl-10 pr-3 py-2 rounded-md bg-[#333] border ${a?"border-red-500 ring-1 ring-red-500":"border-gray-600"} focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all duration-200`;return t==="datetime-local"?`${_} ${m?"appearance-none ios-datetime-fix pl-3":""}`:_};return f.jsxs(R.div,{className:"space-y-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[f.jsx("label",{htmlFor:g,className:"block text-sm font-medium text-gray-300 flex items-center gap-2",children:n}),f.jsxs("div",{className:"relative",children:[!m||t!=="datetime-local"?f.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 z-10",children:e&&f.jsx(d,{className:`${a?"text-red-400":"text-gray-400"} transition-colors duration-200`})}):null,f.jsx("input",{id:g,name:p||g,type:t,className:v(),placeholder:r,value:s,onChange:i,min:o,max:l,required:u,onInvalid:c,"aria-invalid":a?"true":"false",style:t==="datetime-local"&&m?{paddingLeft:"1rem"}:{}})]}),f.jsx(te,{children:a&&f.jsxs(R.div,{className:"text-red-500 text-sm flex items-center gap-1.5",initial:{opacity:0,y:-10,height:0},animate:{opacity:1,y:0,height:"auto"},exit:{opacity:0,y:-10,height:0},transition:{duration:.2},children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),f.jsx("span",{children:a})]})})]})}function js(){return f.jsxs(R.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-amber-900/40 border border-amber-500 text-amber-200 px-4 py-3 rounded-md flex items-start gap-3",children:[f.jsx(ps,{className:"text-amber-500 text-xl flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium",children:"Medication limit reached"}),f.jsx("p",{className:"text-sm mt-1",children:"You've reached the maximum of 10 medications. Please remove some before adding new ones."})]})]})}function Os({disabled:n}){return f.jsx(R.button,{type:"submit",className:`w-full py-3 px-4 rounded-md text-white font-medium transition-all duration-300 ${n?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700"}`,whileHover:n?{}:{scale:1.02},whileTap:n?{}:{scale:.98},disabled:n,children:"Add Medication"})}function Sn({label:n,onClick:e,isActive:t,color:r}){const s={blue:t?"bg-blue-500/30 border-blue-500/50":"bg-[#3a3a3a] border-transparent hover:bg-[#424242]",purple:t?"bg-purple-500/30 border-purple-500/50":"bg-[#3a3a3a] border-transparent hover:bg-[#424242]",green:t?"bg-green-500/30 border-green-500/50":"bg-[#3a3a3a] border-transparent hover:bg-[#424242]"},i={blue:t?"text-blue-300":"text-gray-300",purple:t?"text-purple-300":"text-gray-300",green:t?"text-green-300":"text-gray-300"};return f.jsx(R.button,{type:"button",className:`text-xs ${s[r]} ${i[r]} py-1.5 px-3 rounded-md border transition-colors duration-200`,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},children:n})}function ks({value:n,onChange:e,error:t,activeInterval:r,setActiveInterval:s,errorAnimationVariants:i}){const[a,o]=D.useState(!1),l=D.useRef(null);D.useEffect(()=>{let h;return a&&(h=setTimeout(()=>{o(!1)},7e3)),()=>clearTimeout(h)},[a]);const u=[{label:"4 hours",value:4},{label:"6 hours",value:6},{label:"8 hours",value:8},{label:"12 hours",value:12},{label:"Daily",value:24},{label:"2 days",value:48}],c=h=>{e(h.toString()),s(h)};return l.current={closeTooltip:()=>o(!1)},f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("label",{htmlFor:"interval",className:"block text-sm font-medium text-gray-300",children:"Dosage Interval (hours)"}),f.jsxs("div",{className:"relative",ref:l,children:[f.jsx(nt,{className:"text-gray-400 hover:text-blue-400 cursor-pointer",onClick:()=>o(!a)}),f.jsx(te,{children:a&&f.jsxs(R.div,{className:"absolute z-10 bg-gray-800 p-3 rounded-md shadow-lg text-xs w-56 -right-15 mt-2",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[f.jsx("p",{children:"Common intervals:"}),f.jsxs("ul",{className:"list-disc pl-4 mt-1",children:[f.jsx("li",{children:"4 hours: For medications needed frequently"}),f.jsx("li",{children:"6-8 hours: Common for antibiotics"}),f.jsx("li",{children:"12-24 hours: For daily medications"}),f.jsx("li",{children:"48-72 hours: For less frequent treatments"})]})]})})]})]}),f.jsx("div",{className:"flex items-center",children:f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"relative",children:[f.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(wn,{className:"text-gray-400"})}),f.jsx("input",{type:"number",id:"interval",name:"interval",placeholder:"Enter interval in hours",className:`w-full pl-10 pr-3 py-2 rounded-md bg-[#333] border ${t?"border-red-500":"border-gray-600"} focus:outline-none focus:border-blue-500`,value:n,onChange:h=>{e(h.target.value),s(parseInt(h.target.value)||null)},min:"1",max:"72"})]}),f.jsx(te,{children:t&&f.jsx(R.p,{className:"mt-1 text-sm text-red-500",variants:i,initial:"initial",animate:"animate",exit:"exit",children:t})})]})}),f.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:u.map(h=>f.jsx(Sn,{label:h.label,onClick:()=>c(h.value),isActive:r===h.value,color:"blue"},h.value))})]})}function As({value:n,onChange:e,error:t,activeDuration:r,setActiveDuration:s,errorAnimationVariants:i}){const a=[{label:"1 day",value:1},{label:"2 days",value:2},{label:"3 days",value:3},{label:"5 days",value:5},{label:"1 week",value:7},{label:"2 weeks",value:14}],o=l=>{e(l.toString()),s(l)};return f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-300",children:"Duration (days)"}),f.jsxs("div",{className:"relative",children:[f.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:f.jsx(st,{className:"text-gray-400"})}),f.jsx("input",{type:"number",id:"duration",name:"duration",placeholder:"Enter duration in days",className:`w-full pl-10 pr-3 py-2 rounded-md bg-[#333] border ${t?"border-red-500":"border-gray-600"} focus:outline-none focus:border-blue-500`,value:n,onChange:l=>{e(l.target.value),s(parseInt(l.target.value)||null)},min:"1",max:"31"})]}),f.jsx(te,{children:t&&f.jsx(R.p,{className:"text-sm text-red-500",variants:i,initial:"initial",animate:"animate",exit:"exit",children:t})}),f.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map(l=>f.jsx(Sn,{label:l.label,onClick:()=>o(l.value),isActive:r===l.value,color:"purple"},l.value))})]})}function $s(n,e,t,r,s,i){const a={};if(i)return a.limit="Cannot add more than 10 medications",{isValid:!1,errors:a};if(n.trim()?/[^a-zA-Z0-9 ]/.test(n)?a.medicine="Medicine name must not contain special characters":n.length>50&&(a.medicine="Medicine name must be less than 50 characters"):a.medicine="Medicine name is required",e?!Number.isInteger(Number(e))||parseInt(e)<=0?a.interval="Interval must be a positive integer":[...Array(24).keys()].map(c=>c+1).concat([48,72]).includes(parseInt(e))||(a.interval="Interval must be a number between 1-24, 48, or 72 hours"):a.interval="Interval is required",!t)a.duration="Duration is required";else if(!Number.isInteger(Number(t))||parseInt(t)<=0)a.duration="Duration must be a positive integer";else if(parseInt(t)>31)a.duration="Duration must be less than 31 days";else{const u=parseInt(e),c=parseInt(t);u===48&&c%2!==0?a.duration="When interval is 48 hours, duration must be a multiple of 2 days":u===72&&c%3!==0&&(a.duration="When interval is 72 hours, duration must be a multiple of 3 days")}s!=null&&s.some(u=>u.name.toLowerCase()===n.toLowerCase())&&(a.medicine="This medicine already exists");const o=parseInt(e),l=parseInt(t);return o&&l&&o>l*24&&(a.interval="Interval cannot be greater than total duration in hours"),r?isNaN(Date.parse(r))&&(a.startTime="Invalid date and time format"):a.startTime="Start time is required",{isValid:Object.keys(a).length===0,errors:a}}function Cs({onSubmit:n,existingMedicines:e}){const[t,r]=D.useState(""),[s,i]=D.useState(""),[a,o]=D.useState(""),[l,u]=D.useState(()=>{const w=new Date,S=w.getTimezoneOffset()*6e4;return new Date(w-S).toISOString().slice(0,16)}),[c,h]=D.useState({}),[p,d]=D.useState(null),[m,y]=D.useState(null),g=D.useRef(null),v=D.useRef(null),_=(e==null?void 0:e.length)>=10;D.useEffect(()=>{function w(S){var O,$;v.current&&!v.current.contains(S.target)&&(($=(O=v.current).closeTooltip)==null||$.call(O))}return document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[v]);function T(w){w.preventDefault();const{isValid:S,errors:O}=$s(t,s,a,l,e,_);if(h(O),S){const $={name:t,interval:parseInt(s),duration:parseInt(a),startTime:new Date(l).toISOString()};n($),r(""),i(""),o(""),b(),h({}),d(null),y(null)}}function E(w){const S=w.getFullYear(),O=String(w.getMonth()+1).padStart(2,"0"),$=String(w.getDate()).padStart(2,"0"),A=String(w.getHours()).padStart(2,"0"),U=String(w.getMinutes()).padStart(2,"0");return`${S}-${O}-${$}T${A}:${U}`}function b(){const w=new Date,S=w.getTimezoneOffset()*6e4,O=new Date(w-S);u(E(O))}const x={initial:{opacity:0,y:-5,scale:.95},animate:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:300,damping:20}},exit:{opacity:0,y:-5,scale:.95,transition:{duration:.2}}};return f.jsxs("div",{className:"space-y-4",children:[_&&f.jsx(js,{}),c.limit&&f.jsx("div",{className:"bg-red-900/40 border border-red-500 text-red-200 px-4 py-3 rounded-md mb-4",children:c.limit}),f.jsxs("form",{onSubmit:T,className:"space-y-3",ref:g,children:[f.jsx(yr,{label:"Medication Name",icon:Me,type:"text",placeholder:"Enter medication name",value:t,onChange:w=>r(w.target.value),error:c.medicine,id:"medication-name",name:"medicine"}),f.jsx(ks,{value:s,onChange:i,error:c.interval,activeInterval:p,setActiveInterval:d,errorAnimationVariants:x}),f.jsx(As,{value:a,onChange:o,error:c.duration,activeDuration:m,setActiveDuration:y,errorAnimationVariants:x}),f.jsx(yr,{label:"Start Date and Time",icon:Nt,type:"datetime-local",value:l,onChange:w=>u(w.target.value),error:c.startTime,min:E(new Date(Date.now()-864e5)),max:E(new Date(new Date().setMonth(new Date().getMonth()+1))),required:!0,onInvalid:w=>w.preventDefault(),id:"start-time",name:"startTime"}),f.jsx("div",{className:"mt-6",children:f.jsx(Os,{disabled:_})})]})]})}function Ps({medicine:n}){const e=r=>{const s=new Date(r);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(s)},t=(r,s)=>{const i=new Date(r),a=new Date(i);return a.setDate(i.getDate()+s),new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(a)};return f.jsxs("div",{className:"grid sm:grid-cols-2 gap-3 text-sm",children:[f.jsx(Be,{icon:f.jsx(wn,{className:"text-purple-400"}),bgColor:"bg-purple-500/20",label:"Interval",value:n.interval===24?"Once daily":n.interval===12?"Twice daily":`Every ${n.interval} hours`}),f.jsx(Be,{icon:f.jsx(st,{className:"text-green-400"}),bgColor:"bg-green-500/20",label:"Duration",value:`${n.duration} ${n.duration===1?"day":"days"}`}),f.jsx(Be,{icon:f.jsx(Nt,{className:"text-amber-400"}),bgColor:"bg-amber-500/20",label:"Start",value:e(n.startTime)}),f.jsx(Be,{icon:f.jsx(Nt,{className:"text-red-400"}),bgColor:"bg-red-500/20",label:"End",value:t(n.startTime,n.duration)})]})}function Be({icon:n,bgColor:e,label:t,value:r}){return f.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[f.jsx("div",{className:`${e} p-1.5 rounded`,children:n}),f.jsxs("div",{children:[f.jsx("div",{className:"text-xs text-gray-400",children:t}),f.jsx("div",{children:r})]})]})}function Rs({onDelete:n,medicineName:e}){return f.jsx(R.button,{onClick:n,className:"bg-red-500/10 hover:bg-red-500/80 text-red-400 hover:text-white p-2 rounded-full transition-colors duration-200",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":`Delete ${e}`,title:`Delete ${e}`,children:f.jsx(ms,{})})}function Ds({medicine:n,onDelete:e,index:t}){return f.jsx(R.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-10,transition:{duration:.2}},transition:{duration:.3,type:"spring",stiffness:500,damping:30},className:"bg-gradient-to-r from-[#2d2d2d] to-[#323232] p-5 rounded-lg border border-gray-700 shadow-md hover:border-purple-500/30 transition-colors duration-300",children:f.jsxs("div",{className:"flex justify-between items-start gap-4",children:[f.jsxs("div",{className:"space-y-3 flex-1",children:[f.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f.jsx("div",{className:"bg-blue-500/20 p-1.5 rounded",children:f.jsx(Me,{className:"text-blue-400"})}),f.jsx("h3",{className:"font-semibold text-lg text-white",children:n.name})]}),f.jsx(Ps,{medicine:n})]}),f.jsx(Rs,{onDelete:()=>e(t),medicineName:n.name})]})},`med-${t}`)}function Is(){return f.jsxs(R.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.4,ease:"easeInOut"},className:"flex flex-col items-center justify-center py-10 text-center rounded-lg h-full",children:[f.jsx("div",{className:"bg-gray-700/30 p-4 rounded-full mb-5",children:f.jsx(Me,{className:"text-4xl text-purple-400/80"})}),f.jsx("h3",{className:"text-xl font-medium mb-3 text-gray-300",children:"No medications added yet"}),f.jsx("p",{className:"text-sm max-w-xs text-gray-400 px-6",children:"Add your first medication using the form to start tracking your medication schedule."}),f.jsx(R.div,{className:"mt-8 bg-purple-500/10 border border-purple-500/20 text-purple-300 rounded-md px-4 py-2 text-sm",initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Me,{}),f.jsx("span",{children:"Get started with your first medication"})]})})]},"empty")}function Ns({count:n}){return n===0?null:f.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"pt-3 border-t border-gray-700/30 mt-3 h-[40px] flex items-center justify-center",children:f.jsx("div",{className:"text-sm text-gray-400 text-center",children:f.jsxs("p",{children:["Total: ",n," ",n===1?"medication":"medications"]})})})}function Fs({medicines:n,onDelete:e}){return f.jsxs("div",{className:"flex flex-col h-[28rem]",children:[f.jsx("div",{className:"flex-grow overflow-hidden",children:f.jsx(te,{mode:"wait",children:n.length===0?f.jsx(Is,{}):f.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},className:"h-full overflow-y-auto pr-1 custom-scrollbar",style:{scrollbarWidth:"thin",scrollbarColor:"#4a5568 #2d3748"},children:f.jsx("div",{className:"grid gap-4 pb-2",children:f.jsx(te,{children:n.map((t,r)=>f.jsx(Ds,{medicine:t,onDelete:e,index:r},`med-${r}`))})})},"list")})}),f.jsx(Ns,{count:n.length})]})}var se={},ot={},Re={},ie={};let Ls="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",En=n=>crypto.getRandomValues(new Uint8Array(n)),jn=(n,e,t)=>{let r=(2<<Math.log(n.length-1)/Math.LN2)-1,s=-~(1.6*r*e/n.length);return(i=e)=>{let a="";for(;;){let o=t(s),l=s|0;for(;l--;)if(a+=n[o[l]&r]||"",a.length===i)return a}}},Us=(n,e=21)=>jn(n,e,En),Ms=(n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");const qs=Object.freeze(Object.defineProperty({__proto__:null,customAlphabet:Us,customRandom:jn,nanoid:Ms,random:En,urlAlphabet:Ls},Symbol.toStringTag,{value:"Module"})),zs=Wt(qs);var vr;function Bs(){if(vr)return ie;vr=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.headerDefaults=ie.eventDefaults=void 0;var n=zs;return ie.headerDefaults=function(){return{productId:"adamgibbons/ics",method:"PUBLISH"}},ie.eventDefaults=function(){return{title:"Untitled event",uid:(0,n.nanoid)(),timestamp:Date.now()}},ie}var br;function Vs(){if(br)return Re;br=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.buildEvent=o,Re.buildHeader=a;var n=Bs();function e(l){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},e(l)}function t(l,u,c){return u=r(u),u in l?Object.defineProperty(l,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):l[u]=c,l}function r(l){var u=s(l,"string");return e(u)==="symbol"?u:String(u)}function s(l,u){if(e(l)!=="object"||l===null)return l;var c=l[Symbol.toPrimitive];if(c!==void 0){var h=c.call(l,u);if(e(h)!=="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(u==="string"?String:Number)(l)}function i(l){return Object.entries(l).reduce(function(u,c){return typeof c[1]<"u"?Object.assign(u,t({},c[0],c[1])):u},{})}function a(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=Object.assign({},(0,n.headerDefaults)(),l);return i(u)}function o(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=Object.assign({},(0,n.eventDefaults)(),l);return i(u)}return Re}var pe={},lt={},ut={},_r;function On(){return _r||(_r=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;function e(u,c){return a(u)||i(u,c)||r(u,c)||t()}function t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(u,c){if(u){if(typeof u=="string")return s(u,c);var h=Object.prototype.toString.call(u).slice(8,-1);if(h==="Object"&&u.constructor&&(h=u.constructor.name),h==="Map"||h==="Set")return Array.from(u);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return s(u,c)}}function s(u,c){(c==null||c>u.length)&&(c=u.length);for(var h=0,p=new Array(c);h<c;h++)p[h]=u[h];return p}function i(u,c){var h=u==null?null:typeof Symbol<"u"&&u[Symbol.iterator]||u["@@iterator"];if(h!=null){var p,d,m,y,g=[],v=!0,_=!1;try{if(m=(h=h.call(u)).next,c===0){if(Object(h)!==h)return;v=!1}else for(;!(v=(p=m.call(h)).done)&&(g.push(p.value),g.length!==c);v=!0);}catch(T){_=!0,d=T}finally{try{if(!v&&h.return!=null&&(y=h.return(),Object(y)!==y))return}finally{if(_)throw d}}return g}}function a(u){if(Array.isArray(u))return u}var o=function(c){return c<10?"0".concat(c):"".concat(c)};function l(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"utc",h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"local";if(typeof u=="string")return u;if(Array.isArray(u)&&u.length===3){var p=e(u,3),d=p[0],m=p[1],y=p[2];return"".concat(d).concat(o(m)).concat(o(y))}var g=new Date;if(Array.isArray(u)&&u.length>0&&u[0]){var v=e(u,6),_=v[0],T=v[1],E=v[2],b=v[3],x=b===void 0?0:b,w=v[4],S=w===void 0?0:w,O=v[5],$=O===void 0?0:O;h==="local"?g=new Date(_,T-1,E,x,S,$):g=new Date(Date.UTC(_,T-1,E,x,S,$))}else Array.isArray(u)||(g=new Date(u));return c==="local"?[g.getFullYear(),o(g.getMonth()+1),o(g.getDate()),"T",o(g.getHours()),o(g.getMinutes()),o(g.getSeconds())].join(""):[g.getUTCFullYear(),o(g.getUTCMonth()+1),o(g.getUTCDate()),"T",o(g.getUTCHours()),o(g.getUTCMinutes()),o(g.getUTCSeconds()),"Z"].join("")}}(ut)),ut}var ct={},wr;function Hs(){return wr||(wr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=e;function e(t){var r=t.lat,s=t.lon;return"".concat(r,";").concat(s)}}(ct)),ct}var dt={},ht={},xr;function Yt(){return xr||(xr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=e;function e(t){return'"'.concat(t.replaceAll('"','\\"'),'"')}}(ht)),ht}var Tr;function Gs(){return Tr||(Tr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=r;var e=t(Yt());function t(s){return s&&s.__esModule?s:{default:s}}function r(s){var i=s.name,a=s.email,o=s.rsvp,l=s.dir,u=s.partstat,c=s.role,h=s.cutype,p=s.xNumGuests,d=[];o!==void 0&&d.push(o?"RSVP=TRUE":"RSVP=FALSE"),h&&d.push("CUTYPE=".concat((0,e.default)(h))),p!==void 0&&d.push("X-NUM-GUESTS=".concat(p)),c&&d.push("ROLE=".concat((0,e.default)(c))),u&&d.push("PARTSTAT=".concat((0,e.default)(u))),l&&d.push("DIR=".concat((0,e.default)(l))),d.push("CN=".concat((0,e.default)(i||"Unnamed attendee")));var m=d.join(";").concat(a?":mailto:".concat(a):"");return m}}(dt)),dt}var ft={},Sr;function Js(){return Sr||(Sr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=r;var e=t(Yt());function t(s){return s&&s.__esModule?s:{default:s}}function r(s){var i=s.name,a=s.email,o=s.dir,l=s.sentBy,u="";return u+=o?"DIR=".concat((0,e.default)(o),";"):"",u+=l?"SENT-BY=".concat((0,e.default)("MAILTO:".concat(l)),";"):"",u+="CN=",u+=(0,e.default)(i||"Organizer"),u+=a?":MAILTO:".concat(a):"",u}}(ft)),ft}var pt={},mt={},gt={exports:{}},yt={exports:{}},Er;function Ks(){if(Er)return yt.exports;Er=1;var n;(function(d){d[d.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",d[d.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",d[d.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",d[d.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",d[d.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",d[d.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",d[d.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",d[d.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",d[d.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",d[d.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",d[d.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",d[d.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",d[d.TAGS_START=917504]="TAGS_START",d[d.TAGS_END=917631]="TAGS_END",d[d.ZWJ=8205]="ZWJ"})(n||(n={}));const e=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var t;function r(d){if(typeof d!="string")throw new TypeError("string cannot be undefined or null");const m=[];let y=0,g=0;for(;y<d.length;)g+=s(y+g,d),l(d[y+g])&&g++,a(d[y+g])&&g++,o(d[y+g])&&g++,u(d[y+g])?g++:(m.push(d.substring(y,y+g)),y+=g,g=0);return m}function s(d,m){const y=m[d];if(!function(T){return T&&h(T[0].charCodeAt(0),55296,56319)}(y)||d===m.length-1)return 1;const g=y+m[d+1];let v=m.substring(d+2,d+5);return i(g)&&i(v)?4:function(T){return h(c(T),127988,127988)}(g)&&function(T){const E=T.codePointAt(0);return typeof T=="string"&&typeof E=="number"&&h(E,917504,917631)}(v)?m.slice(d).indexOf(String.fromCodePoint(917631))+2:function(T){return h(c(T),127995,127999)}(v)?4:2}function i(d){return h(c(d),127462,127487)}function a(d){return typeof d=="string"&&h(d.charCodeAt(0),65024,65039)}function o(d){return typeof d=="string"&&h(d.charCodeAt(0),8400,8447)}function l(d){return typeof d=="string"&&e.includes(d.charCodeAt(0))}function u(d){return typeof d=="string"&&d.charCodeAt(0)===8205}function c(d){return(d.charCodeAt(0)-55296<<10)+(d.charCodeAt(1)-56320)+65536}function h(d,m,y){return d>=m&&d<=y}function p(d,m,y){const g=r(d);if(m===void 0)return d;if(m>=g.length)return"";const v=g.length-m;let _=m+(y===void 0?v:y);return _>m+v&&(_=void 0),g.slice(m,_).join("")}return function(d){d[d.unit_1=1]="unit_1",d[d.unit_2=2]="unit_2",d[d.unit_4=4]="unit_4"}(t||(t={})),Object.defineProperty(r,"runes",{value:r}),Object.defineProperty(r,"default",{value:r}),Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"substr",{value:p}),Object.defineProperty(r,"substring",{value:p}),Object.defineProperty(r,"EnumRunesCode",{value:n}),Object.defineProperty(r,"EnumCodeUnits",{value:t}),Object.defineProperty(r,"GRAPHEMES",{value:e}),yt.exports=r,yt.exports}var jr;function Ws(){return jr||(jr=1,gt.exports=Ks()),gt.exports}var Or;function kn(){return Or||(Or=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=t;var e=Ws();function t(r){for(var s=[],i=75;(0,e.runes)(r).length>i;)s.push((0,e.substring)(r,0,i)),r=(0,e.substring)(r,i),i=74;return s.push(r),s.join(`\r
	`)}}(mt)),mt}var vt={},kr;function An(){return kr||(kr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=e;function e(t){return t.replace(/\r?\n/gm,"\\n")}}(vt)),vt}var Ar;function Ys(){return Ar||(Ar=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var e=s(On()),t=s(kn()),r=s(An());function s(u){return u&&u.__esModule?u:{default:u}}function i(u){var c=u.weeks,h=u.days,p=u.hours,d=u.minutes,m=u.seconds,y="P";return y+=c?"".concat(c,"W"):"",y+=h?"".concat(h,"D"):"",y+="T",y+=p?"".concat(p,"H"):"",y+=d?"".concat(d,"M"):"",y+=m?"".concat(m,"S"):"",y}function a(u){var c="";if(Array.isArray(u)||typeof u=="number"||typeof u=="string")c="TRIGGER;VALUE=DATE-TIME:".concat((0,r.default)((0,e.default)(u)),`\r
`);else{var h=u.before?"-":"";c="TRIGGER:".concat((0,r.default)(h+i(u)),`\r
`)}return c}function o(u){return u.toUpperCase()}function l(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=u.action,h=u.repeat,p=u.description,d=u.duration,m=u.attach,y=u.attachType,g=u.trigger,v=u.summary,_=`BEGIN:VALARM\r
`;_+=(0,t.default)("ACTION:".concat((0,r.default)(o(c))))+`\r
`,_+=h?(0,t.default)("REPEAT:".concat(h))+`\r
`:"",_+=p?(0,t.default)("DESCRIPTION:".concat((0,r.default)(p)))+`\r
`:"",_+=d?(0,t.default)("DURATION:".concat(i(d)))+`\r
`:"";var T=y||"FMTTYPE=audio/basic";return _+=m?(0,t.default)((0,r.default)("ATTACH;".concat(T,":").concat(m)))+`\r
`:"",_+=g?a(g):"",_+=v?(0,t.default)("SUMMARY:".concat((0,r.default)(v)))+`\r
`:"",_+=`END:VALARM\r
`,_}}(pt)),pt}var bt={},_t={},$r;function Zt(){return $r||($r=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=e;function e(t){return t.replace(/\\/gm,"\\\\").replace(/\r?\n/gm,"\\n").replace(/;/gm,"\\;").replace(/,/gm,"\\,")}}(_t)),_t}var Cr;function Zs(){return Cr||(Cr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=r;var e=t(Zt());function t(s){return s&&s.__esModule?s:{default:s}}function r(s){return(0,e.default)(s)}}(bt)),bt}var wt={},Pr;function Qs(){return Pr||(Pr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=r;var e=t(Zt());function t(s){return s&&s.__esModule?s:{default:s}}function r(s){return(0,e.default)(s)}}(wt)),wt}var xt={},Rr;function Xs(){return Rr||(Rr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=e;function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.weeks,s=t.days,i=t.hours,a=t.minutes,o=t.seconds,l="P";return l+=r?"".concat(r,"W"):"",l+=s?"".concat(s,"D"):"",l+="T",l+=i?"".concat(i,"H"):"",l+=a?"".concat(a,"M"):"",l+=o?"".concat(o,"S"):"",l}}(xt)),xt}var Tt={},Dr;function ei(){return Dr||(Dr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=r;var e=t(Zt());function t(s){return s&&s.__esModule?s:{default:s}}function r(s){return(0,e.default)(s)}}(Tt)),Tt}var Ir;function ti(){return Ir||(Ir=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"encodeParamValue",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(n,"foldLine",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"formatDate",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"formatDuration",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"setAlarm",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"setContact",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"setDescription",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"setGeolocation",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"setLocation",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"setOrganizer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"setSummary",{enumerable:!0,get:function(){return o.default}});var e=p(On()),t=p(Hs()),r=p(Gs()),s=p(Js()),i=p(Ys()),a=p(Zs()),o=p(Qs()),l=p(Xs()),u=p(kn()),c=p(ei()),h=p(Yt());function p(d){return d&&d.__esModule?d:{default:d}}}(lt)),lt}var Nr;function ri(){if(Nr)return pe;Nr=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.formatEvent=i,pe.formatFooter=s,pe.formatHeader=r;var n=ti(),e=t(An());function t(a){return a&&a.__esModule?a:{default:a}}function r(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=a.productId,l=a.method,u=a.calName,c="";return c+=`BEGIN:VCALENDAR\r
`,c+=`VERSION:2.0\r
`,c+=`CALSCALE:GREGORIAN\r
`,c+=(0,n.foldLine)("PRODID:".concat((0,e.default)(o)))+`\r
`,c+=(0,n.foldLine)("METHOD:".concat((0,e.default)(l)))+`\r
`,c+=u?(0,n.foldLine)("X-WR-CALNAME:".concat((0,e.default)(u)))+`\r
`:"",c+=`X-PUBLISHED-TTL:PT1H\r
`,c}function s(){return`END:VCALENDAR\r
`}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=a.title,l=a.uid,u=a.sequence,c=a.timestamp,h=a.start,p=a.startType,d=a.startInputType,m=a.startOutputType,y=a.duration,g=a.end,v=a.endInputType,_=a.endOutputType,T=a.description,E=a.url,b=a.geo,x=a.location,w=a.status,S=a.categories,O=a.organizer,$=a.attendees,A=a.alarms,U=a.recurrenceRule,Ce=a.exclusionDates,Pe=a.busyStatus,hr=a.transp,fr=a.classification,pr=a.created,mr=a.lastModified,gr=a.htmlContent,C="";return C+=`BEGIN:VEVENT\r
`,C+=(0,n.foldLine)("UID:".concat((0,e.default)(l)))+`\r
`,C+=o?(0,n.foldLine)("SUMMARY:".concat((0,e.default)((0,n.setSummary)(o))))+`\r
`:"",C+=(0,n.foldLine)("DTSTAMP:".concat((0,e.default)((0,n.formatDate)(c))))+`\r
`,C+=(0,n.foldLine)("DTSTART".concat(h&&h.length==3?";VALUE=DATE":"",":").concat((0,e.default)((0,n.formatDate)(h,m||p,d))))+`\r
`,(!g||g.length!==3||h.length!==g.length||h.some(function(ne,fs){return ne!==g[fs]}))&&g&&(C+=(0,n.foldLine)("DTEND".concat(g.length===3?";VALUE=DATE":"",":").concat((0,e.default)((0,n.formatDate)(g,_||m||p,v||d))))+`\r
`),C+=typeof u<"u"?"SEQUENCE:".concat(u,`\r
`):"",C+=T?(0,n.foldLine)("DESCRIPTION:".concat((0,e.default)((0,n.setDescription)(T))))+`\r
`:"",C+=E?(0,n.foldLine)("URL:".concat((0,e.default)(E)))+`\r
`:"",C+=b?(0,n.foldLine)("GEO:".concat((0,n.setGeolocation)(b)))+`\r
`:"",C+=x?(0,n.foldLine)("LOCATION:".concat((0,e.default)((0,n.setLocation)(x))))+`\r
`:"",C+=w?(0,n.foldLine)("STATUS:".concat((0,e.default)(w)))+`\r
`:"",C+=S?(0,n.foldLine)("CATEGORIES:".concat((0,e.default)(S.join(","))))+`\r
`:"",C+=O?(0,n.foldLine)("ORGANIZER;".concat((0,n.setOrganizer)(O)))+`\r
`:"",C+=Pe?(0,n.foldLine)("X-MICROSOFT-CDO-BUSYSTATUS:".concat((0,e.default)(Pe)))+`\r
`:"",C+=hr?(0,n.foldLine)("TRANSP:".concat((0,e.default)(hr)))+`\r
`:"",C+=fr?(0,n.foldLine)("CLASS:".concat((0,e.default)(fr)))+`\r
`:"",C+=pr?"CREATED:"+(0,e.default)((0,n.formatDate)(pr))+`\r
`:"",C+=mr?"LAST-MODIFIED:"+(0,e.default)((0,n.formatDate)(mr))+`\r
`:"",C+=gr?(0,n.foldLine)("X-ALT-DESC;FMTTYPE=text/html:".concat((0,e.default)(gr)))+`\r
`:"",$&&$.forEach(function(ne){C+=(0,n.foldLine)("ATTENDEE;".concat((0,e.default)((0,n.setContact)(ne))))+`\r
`}),C+=U?(0,n.foldLine)("RRULE:".concat((0,e.default)(U)))+`\r
`:"",C+=Ce?(0,n.foldLine)("EXDATE:".concat((0,e.default)(Ce.map(function(ne){return(0,n.formatDate)(ne)}).join(","))))+`\r
`:"",C+=y?(0,n.foldLine)("DURATION:".concat((0,n.formatDuration)(y)))+`\r
`:"",A&&A.forEach(function(ne){C+=(0,n.setAlarm)(ne)}),C+=`END:VEVENT\r
`,C}return pe}var St={},ae={},Et,Fr;function ni(){if(Fr)return Et;Fr=1;function n(v){this._maxSize=v,this.clear()}n.prototype.clear=function(){this._size=0,this._values=Object.create(null)},n.prototype.get=function(v){return this._values[v]},n.prototype.set=function(v,_){return this._size>=this._maxSize&&this.clear(),v in this._values||this._size++,this._values[v]=_};var e=/[^.^\]^[]+|(?=\[\]|\.\.)/g,t=/^\d+$/,r=/^\d/,s=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,i=/^\s*(['"]?)(.*?)(\1)\s*$/,a=512,o=new n(a),l=new n(a),u=new n(a);Et={Cache:n,split:h,normalizePath:c,setter:function(v){var _=c(v);return l.get(v)||l.set(v,function(E,b){for(var x=0,w=_.length,S=E;x<w-1;){var O=_[x];if(O==="__proto__"||O==="constructor"||O==="prototype")return E;S=S[_[x++]]}S[_[x]]=b})},getter:function(v,_){var T=c(v);return u.get(v)||u.set(v,function(b){for(var x=0,w=T.length;x<w;)if(b!=null||!_)b=b[T[x++]];else return;return b})},join:function(v){return v.reduce(function(_,T){return _+(d(T)||t.test(T)?"["+T+"]":(_?".":"")+T)},"")},forEach:function(v,_,T){p(Array.isArray(v)?v:h(v),_,T)}};function c(v){return o.get(v)||o.set(v,h(v).map(function(_){return _.replace(i,"$2")}))}function h(v){return v.match(e)||[""]}function p(v,_,T){var E=v.length,b,x,w,S;for(x=0;x<E;x++)b=v[x],b&&(g(b)&&(b='"'+b+'"'),S=d(b),w=!S&&/^\d+$/.test(b),_.call(T,b,S,w,x,v))}function d(v){return typeof v=="string"&&v&&["'",'"'].indexOf(v.charAt(0))!==-1}function m(v){return v.match(r)&&!v.match(t)}function y(v){return s.test(v)}function g(v){return!d(v)&&(m(v)||y(v))}return Et}var ce=ni(),jt,Lr;function si(){if(Lr)return jt;Lr=1;const n=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['’](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['’](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,e=c=>c.match(n)||[],t=c=>c[0].toUpperCase()+c.slice(1),r=(c,h)=>e(c).join(h).toLowerCase(),s=c=>e(c).reduce((h,p)=>`${h}${h?p[0].toUpperCase()+p.slice(1).toLowerCase():p.toLowerCase()}`,"");return jt={words:e,upperFirst:t,camelCase:s,pascalCase:c=>t(s(c)),snakeCase:c=>r(c,"_"),kebabCase:c=>r(c,"-"),sentenceCase:c=>t(r(c," ")),titleCase:c=>e(c).map(t).join(" ")},jt}var Ot=si(),Ve={exports:{}},Ur;function ii(){if(Ur)return Ve.exports;Ur=1,Ve.exports=function(s){return n(e(s),s)},Ve.exports.array=n;function n(s,i){var a=s.length,o=new Array(a),l={},u=a,c=t(i),h=r(s);for(i.forEach(function(d){if(!h.has(d[0])||!h.has(d[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});u--;)l[u]||p(s[u],u,new Set);return o;function p(d,m,y){if(y.has(d)){var g;try{g=", node was:"+JSON.stringify(d)}catch{g=""}throw new Error("Cyclic dependency"+g)}if(!h.has(d))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(d));if(!l[m]){l[m]=!0;var v=c.get(d)||new Set;if(v=Array.from(v),m=v.length){y.add(d);do{var _=v[--m];p(_,h.get(_),y)}while(m);y.delete(d)}o[--a]=d}}}function e(s){for(var i=new Set,a=0,o=s.length;a<o;a++){var l=s[a];i.add(l[0]),i.add(l[1])}return Array.from(i)}function t(s){for(var i=new Map,a=0,o=s.length;a<o;a++){var l=s[a];i.has(l[0])||i.set(l[0],new Set),i.has(l[1])||i.set(l[1],new Set),i.get(l[0]).add(l[1])}return i}function r(s){for(var i=new Map,a=0,o=s.length;a<o;a++)i.set(s[a],a);return i}return Ve.exports}var ai=ii();const oi=_n(ai),li=Object.prototype.toString,ui=Error.prototype.toString,ci=RegExp.prototype.toString,di=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",hi=/^Symbol\((.*)\)(.*)$/;function fi(n){return n!=+n?"NaN":n===0&&1/n<0?"-0":""+n}function Mr(n,e=!1){if(n==null||n===!0||n===!1)return""+n;const t=typeof n;if(t==="number")return fi(n);if(t==="string")return e?`"${n}"`:n;if(t==="function")return"[Function "+(n.name||"anonymous")+"]";if(t==="symbol")return di.call(n).replace(hi,"Symbol($1)");const r=li.call(n).slice(8,-1);return r==="Date"?isNaN(n.getTime())?""+n:n.toISOString(n):r==="Error"||n instanceof Error?"["+ui.call(n)+"]":r==="RegExp"?ci.call(n):null}function J(n,e){let t=Mr(n,e);return t!==null?t:JSON.stringify(n,function(r,s){let i=Mr(this[r],e);return i!==null?i:s},2)}function $n(n){return n==null?[]:[].concat(n)}let Cn,Pn,Rn,pi=/\$\{\s*(\w+)\s*\}/g;Cn=Symbol.toStringTag;class qr{constructor(e,t,r,s){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[Cn]="Error",this.name="ValidationError",this.value=t,this.path=r,this.type=s,this.errors=[],this.inner=[],$n(e).forEach(i=>{if(F.isError(i)){this.errors.push(...i.errors);const a=i.inner.length?i.inner:[i];this.inner.push(...a)}else this.errors.push(i)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}Pn=Symbol.hasInstance;Rn=Symbol.toStringTag;class F extends Error{static formatError(e,t){const r=t.label||t.path||"this";return t=Object.assign({},t,{path:r,originalPath:t.path}),typeof e=="string"?e.replace(pi,(s,i)=>J(t[i])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,r,s,i){const a=new qr(e,t,r,s);if(i)return a;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[Rn]="Error",this.name=a.name,this.message=a.message,this.type=a.type,this.value=a.value,this.path=a.path,this.errors=a.errors,this.inner=a.inner,Error.captureStackTrace&&Error.captureStackTrace(this,F)}static[Pn](e){return qr[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let G={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:n,type:e,value:t,originalValue:r})=>{const s=r!=null&&r!==t?` (cast from the value \`${J(r,!0)}\`).`:".";return e!=="mixed"?`${n} must be a \`${e}\` type, but the final value was: \`${J(t,!0)}\``+s:`${n} must match the configured type. The validated value was: \`${J(t,!0)}\``+s}},q={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},Y={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},Ft={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},Lt={isValue:"${path} field must be ${value}"},Ze={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},Qe={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},Dn={notType:n=>{const{path:e,value:t,spec:r}=n,s=r.types.length;if(Array.isArray(t)){if(t.length<s)return`${e} tuple value has too few items, expected a length of ${s} but got ${t.length} for value: \`${J(t,!0)}\``;if(t.length>s)return`${e} tuple value has too many items, expected a length of ${s} but got ${t.length} for value: \`${J(t,!0)}\``}return F.formatError(G.notType,n)}};var In=Object.assign(Object.create(null),{mixed:G,string:q,number:Y,date:Ft,object:Ze,array:Qe,boolean:Lt,tuple:Dn});const de=n=>n&&n.__isYupSchema__;class et{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:r,then:s,otherwise:i}=t,a=typeof r=="function"?r:(...o)=>o.every(l=>l===r);return new et(e,(o,l)=>{var u;let c=a(...o)?s:i;return(u=c==null?void 0:c(l))!=null?u:l})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let r=this.refs.map(i=>i.getValue(t==null?void 0:t.value,t==null?void 0:t.parent,t==null?void 0:t.context)),s=this.fn(r,e,t);if(s===void 0||s===e)return e;if(!de(s))throw new TypeError("conditions must return a schema object");return s.resolve(t)}}const He={context:"$",value:"."};function mi(n,e){return new re(n,e)}class re{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===He.context,this.isValue=this.key[0]===He.value,this.isSibling=!this.isContext&&!this.isValue;let r=this.isContext?He.context:this.isValue?He.value:"";this.path=this.key.slice(r.length),this.getter=this.path&&ce.getter(this.path,!0),this.map=t.map}getValue(e,t,r){let s=this.isContext?r:this.isValue?e:t;return this.getter&&(s=this.getter(s||{})),this.map&&(s=this.map(s)),s}cast(e,t){return this.getValue(e,t==null?void 0:t.parent,t==null?void 0:t.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}re.prototype.__isYupRef=!0;const V=n=>n==null;function me(n){function e({value:t,path:r="",options:s,originalValue:i,schema:a},o,l){const{name:u,test:c,params:h,message:p,skipAbsent:d}=n;let{parent:m,context:y,abortEarly:g=a.spec.abortEarly,disableStackTrace:v=a.spec.disableStackTrace}=s;function _(A){return re.isRef(A)?A.getValue(t,m,y):A}function T(A={}){const U=Object.assign({value:t,originalValue:i,label:a.spec.label,path:A.path||r,spec:a.spec,disableStackTrace:A.disableStackTrace||v},h,A.params);for(const Pe of Object.keys(U))U[Pe]=_(U[Pe]);const Ce=new F(F.formatError(A.message||p,U),t,U.path,A.type||u,U.disableStackTrace);return Ce.params=U,Ce}const E=g?o:l;let b={path:r,parent:m,type:u,from:s.from,createError:T,resolve:_,options:s,originalValue:i,schema:a};const x=A=>{F.isError(A)?E(A):A?l(null):E(T())},w=A=>{F.isError(A)?E(A):o(A)};if(d&&V(t))return x(!0);let O;try{var $;if(O=c.call(b,t,b),typeof(($=O)==null?void 0:$.then)=="function"){if(s.sync)throw new Error(`Validation test of type: "${b.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(O).then(x,w)}}catch(A){w(A);return}x(O)}return e.OPTIONS=n,e}function Qt(n,e,t,r=t){let s,i,a;return e?(ce.forEach(e,(o,l,u)=>{let c=l?o.slice(1,o.length-1):o;n=n.resolve({context:r,parent:s,value:t});let h=n.type==="tuple",p=u?parseInt(c,10):0;if(n.innerType||h){if(h&&!u)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${a}" must contain an index to the tuple element, e.g. "${a}[0]"`);if(t&&p>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${o}, in the path: ${e}. because there is no value at that index. `);s=t,t=t&&t[p],n=h?n.spec.types[p]:n.innerType}if(!u){if(!n.fields||!n.fields[c])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${a} which is a type: "${n.type}")`);s=t,t=t&&t[c],n=n.fields[c]}i=c,a=l?"["+o+"]":"."+o}),{schema:n,parent:s,parentPath:i}):{parent:s,parentPath:e,schema:n}}function gi(n,e,t,r){return Qt(n,e,t,r).schema}class tt extends Set{describe(){const e=[];for(const t of this.values())e.push(re.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const r of this.values())t.push(e(r));return t}clone(){return new tt(this.values())}merge(e,t){const r=this.clone();return e.forEach(s=>r.add(s)),t.forEach(s=>r.delete(s)),r}}function Ee(n,e=new Map){if(de(n)||!n||typeof n!="object")return n;if(e.has(n))return e.get(n);let t;if(n instanceof Date)t=new Date(n.getTime()),e.set(n,t);else if(n instanceof RegExp)t=new RegExp(n),e.set(n,t);else if(Array.isArray(n)){t=new Array(n.length),e.set(n,t);for(let r=0;r<n.length;r++)t[r]=Ee(n[r],e)}else if(n instanceof Map){t=new Map,e.set(n,t);for(const[r,s]of n.entries())t.set(r,Ee(s,e))}else if(n instanceof Set){t=new Set,e.set(n,t);for(const r of n)t.add(Ee(r,e))}else if(n instanceof Object){t={},e.set(n,t);for(const[r,s]of Object.entries(n))t[r]=Ee(s,e)}else throw Error(`Unable to clone ${n}`);return t}class L{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new tt,this._blacklist=new tt,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(G.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e==null?void 0:e.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=Ee(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let r=e(this);return this._mutate=t,r}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,r=e.clone();const s=Object.assign({},t.spec,r.spec);return r.spec=s,r.internalTests=Object.assign({},t.internalTests,r.internalTests),r._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),r._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),r.tests=t.tests,r.exclusiveTests=t.exclusiveTests,r.withMutation(i=>{e.tests.forEach(a=>{i.test(a.OPTIONS)})}),r.transforms=[...t.transforms,...r.transforms],r}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let r=t.conditions;t=t.clone(),t.conditions=[],t=r.reduce((s,i)=>i.resolve(s,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,r,s,i;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(r=e.abortEarly)!=null?r:this.spec.abortEarly,recursive:(s=e.recursive)!=null?s:this.spec.recursive,disableStackTrace:(i=e.disableStackTrace)!=null?i:this.spec.disableStackTrace})}cast(e,t={}){let r=this.resolve(Object.assign({value:e},t)),s=t.assert==="ignore-optionality",i=r._cast(e,t);if(t.assert!==!1&&!r.isType(i)){if(s&&V(i))return i;let a=J(e),o=J(i);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${r.type}". 

attempted value: ${a} 
`+(o!==a?`result of cast: ${o}`:""))}return i}_cast(e,t){let r=e===void 0?e:this.transforms.reduce((s,i)=>i.call(this,s,e,this),e);return r===void 0&&(r=this.getDefault(t)),r}_validate(e,t={},r,s){let{path:i,originalValue:a=e,strict:o=this.spec.strict}=t,l=e;o||(l=this._cast(l,Object.assign({assert:!1},t)));let u=[];for(let c of Object.values(this.internalTests))c&&u.push(c);this.runTests({path:i,value:l,originalValue:a,options:t,tests:u},r,c=>{if(c.length)return s(c,l);this.runTests({path:i,value:l,originalValue:a,options:t,tests:this.tests},r,s)})}runTests(e,t,r){let s=!1,{tests:i,value:a,originalValue:o,path:l,options:u}=e,c=y=>{s||(s=!0,t(y,a))},h=y=>{s||(s=!0,r(y,a))},p=i.length,d=[];if(!p)return h([]);let m={value:a,originalValue:o,path:l,options:u,schema:this};for(let y=0;y<i.length;y++){const g=i[y];g(m,c,function(_){_&&(Array.isArray(_)?d.push(..._):d.push(_)),--p<=0&&h(d)})}}asNestedTest({key:e,index:t,parent:r,parentPath:s,originalParent:i,options:a}){const o=e??t;if(o==null)throw TypeError("Must include `key` or `index` for nested validations");const l=typeof o=="number";let u=r[o];const c=Object.assign({},a,{strict:!0,parent:r,value:u,originalValue:i[o],key:void 0,[l?"index":"key"]:o,path:l||o.includes(".")?`${s||""}[${l?o:`"${o}"`}]`:(s?`${s}.`:"")+e});return(h,p,d)=>this.resolve(c)._validate(u,c,p,d)}validate(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),i=(r=t==null?void 0:t.disableStackTrace)!=null?r:s.spec.disableStackTrace;return new Promise((a,o)=>s._validate(e,t,(l,u)=>{F.isError(l)&&(l.value=u),o(l)},(l,u)=>{l.length?o(new F(l,u,void 0,void 0,i)):a(u)}))}validateSync(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),i,a=(r=t==null?void 0:t.disableStackTrace)!=null?r:s.spec.disableStackTrace;return s._validate(e,Object.assign({},t,{sync:!0}),(o,l)=>{throw F.isError(o)&&(o.value=l),o},(o,l)=>{if(o.length)throw new F(o,e,void 0,void 0,a);i=l}),i}isValid(e,t){return this.validate(e,t).then(()=>!0,r=>{if(F.isError(r))return!1;throw r})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(r){if(F.isError(r))return!1;throw r}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):Ee(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const r=this.clone({nullable:e});return r.internalTests.nullable=me({message:t,name:"nullable",test(s){return s===null?this.schema.spec.nullable:!0}}),r}optionality(e,t){const r=this.clone({optional:e});return r.internalTests.optionality=me({message:t,name:"optionality",test(s){return s===void 0?this.schema.spec.optional:!0}}),r}optional(){return this.optionality(!0)}defined(e=G.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=G.notNull){return this.nullability(!1,e)}required(e=G.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=G.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let r=this.clone(),s=me(t),i=t.exclusive||t.name&&r.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(r.exclusiveTests[t.name]=!!t.exclusive),r.tests=r.tests.filter(a=>!(a.OPTIONS.name===t.name&&(i||a.OPTIONS.test===s.OPTIONS.test))),r.tests.push(s),r}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let r=this.clone(),s=$n(e).map(i=>new re(i));return s.forEach(i=>{i.isSibling&&r.deps.push(i.key)}),r.conditions.push(typeof t=="function"?new et(s,t):et.fromOptions(s,t)),r}typeError(e){let t=this.clone();return t.internalTests.typeError=me({message:e,name:"typeError",skipAbsent:!0,test(r){return this.schema._typeCheck(r)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=G.oneOf){let r=this.clone();return e.forEach(s=>{r._whitelist.add(s),r._blacklist.delete(s)}),r.internalTests.whiteList=me({message:t,name:"oneOf",skipAbsent:!0,test(s){let i=this.schema._whitelist,a=i.resolveAll(this.resolve);return a.includes(s)?!0:this.createError({params:{values:Array.from(i).join(", "),resolved:a}})}}),r}notOneOf(e,t=G.notOneOf){let r=this.clone();return e.forEach(s=>{r._blacklist.add(s),r._whitelist.delete(s)}),r.internalTests.blacklist=me({message:t,name:"notOneOf",test(s){let i=this.schema._blacklist,a=i.resolveAll(this.resolve);return a.includes(s)?this.createError({params:{values:Array.from(i).join(", "),resolved:a}}):!0}}),r}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:r,meta:s,optional:i,nullable:a}=t.spec;return{meta:s,label:r,optional:i,nullable:a,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.map(l=>({name:l.OPTIONS.name,params:l.OPTIONS.params})).filter((l,u,c)=>c.findIndex(h=>h.name===l.name)===u)}}}L.prototype.__isYupSchema__=!0;for(const n of["validate","validateSync"])L.prototype[`${n}At`]=function(e,t,r={}){const{parent:s,parentPath:i,schema:a}=Qt(this,e,t,r.context);return a[n](s&&s[i],Object.assign({},r,{parent:s,path:e}))};for(const n of["equals","is"])L.prototype[n]=L.prototype.oneOf;for(const n of["not","nope"])L.prototype[n]=L.prototype.notOneOf;const yi=()=>!0;function Nn(n){return new Xt(n)}class Xt extends L{constructor(e){super(typeof e=="function"?{type:"mixed",check:e}:Object.assign({type:"mixed",check:yi},e))}}Nn.prototype=Xt.prototype;function Ut(){return new er}class er extends L{constructor(){super({type:"boolean",check(e){return e instanceof Boolean&&(e=e.valueOf()),typeof e=="boolean"}}),this.withMutation(()=>{this.transform((e,t,r)=>{if(r.spec.coerce&&!r.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e})})}isTrue(e=Lt.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test(t){return V(t)||t===!0}})}isFalse(e=Lt.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test(t){return V(t)||t===!1}})}default(e){return super.default(e)}defined(e){return super.defined(e)}optional(){return super.optional()}required(e){return super.required(e)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(e){return super.nonNullable(e)}strip(e){return super.strip(e)}}Ut.prototype=er.prototype;const vi=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function bi(n){const e=Mt(n);if(!e)return Date.parse?Date.parse(n):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function Mt(n){var e,t;const r=vi.exec(n);return r?{year:K(r[1]),month:K(r[2],1)-1,day:K(r[3],1),hour:K(r[4]),minute:K(r[5]),second:K(r[6]),millisecond:r[7]?K(r[7].substring(0,3)):0,precision:(e=(t=r[7])==null?void 0:t.length)!=null?e:void 0,z:r[8]||void 0,plusMinus:r[9]||void 0,hourOffset:K(r[10]),minuteOffset:K(r[11])}:null}function K(n,e=0){return Number(n)||e}let _i=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,wi=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,xi=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Ti="^\\d{4}-\\d{2}-\\d{2}",Si="\\d{2}:\\d{2}:\\d{2}",Ei="(([+-]\\d{2}(:?\\d{2})?)|Z)",ji=new RegExp(`${Ti}T${Si}(\\.\\d+)?${Ei}$`),Oi=n=>V(n)||n===n.trim(),ki={}.toString();function Fn(){return new tr}class tr extends L{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t,r)=>{if(!r.spec.coerce||r.isType(e)||Array.isArray(e))return e;const s=e!=null&&e.toString?e.toString():e;return s===ki?e:s})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||G.required,name:"required",skipAbsent:!0,test:r=>!!r.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=q.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t=q.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t=q.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}matches(e,t){let r=!1,s,i;return t&&(typeof t=="object"?{excludeEmptyString:r=!1,message:s,name:i}=t:s=t),this.test({name:i||"matches",message:s||q.matches,params:{regex:e},skipAbsent:!0,test:a=>a===""&&r||a.search(e)!==-1})}email(e=q.email){return this.matches(_i,{name:"email",message:e,excludeEmptyString:!0})}url(e=q.url){return this.matches(wi,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=q.uuid){return this.matches(xi,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",r,s;return e&&(typeof e=="object"?{message:t="",allowOffset:r=!1,precision:s=void 0}=e:t=e),this.matches(ji,{name:"datetime",message:t||q.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||q.datetime_offset,params:{allowOffset:r},skipAbsent:!0,test:i=>{if(!i||r)return!0;const a=Mt(i);return a?!!a.z:!1}}).test({name:"datetime_precision",message:t||q.datetime_precision,params:{precision:s},skipAbsent:!0,test:i=>{if(!i||s==null)return!0;const a=Mt(i);return a?a.precision===s:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=q.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:Oi})}lowercase(e=q.lowercase){return this.transform(t=>V(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>V(t)||t===t.toLowerCase()})}uppercase(e=q.uppercase){return this.transform(t=>V(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>V(t)||t===t.toUpperCase()})}}Fn.prototype=tr.prototype;let Ai=n=>n!=+n;function Ln(){return new rr}class rr extends L{constructor(){super({type:"number",check(e){return e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&!Ai(e)}}),this.withMutation(()=>{this.transform((e,t,r)=>{if(!r.spec.coerce)return e;let s=e;if(typeof s=="string"){if(s=s.replace(/\s/g,""),s==="")return NaN;s=+s}return r.isType(s)||s===null?s:parseFloat(s)})})}min(e,t=Y.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r>=this.resolve(e)}})}max(e,t=Y.max){return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r<=this.resolve(e)}})}lessThan(e,t=Y.lessThan){return this.test({message:t,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test(r){return r<this.resolve(e)}})}moreThan(e,t=Y.moreThan){return this.test({message:t,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test(r){return r>this.resolve(e)}})}positive(e=Y.positive){return this.moreThan(0,e)}negative(e=Y.negative){return this.lessThan(0,e)}integer(e=Y.integer){return this.test({name:"integer",message:e,skipAbsent:!0,test:t=>Number.isInteger(t)})}truncate(){return this.transform(e=>V(e)?e:e|0)}round(e){var t;let r=["ceil","floor","round","trunc"];if(e=((t=e)==null?void 0:t.toLowerCase())||"round",e==="trunc")return this.truncate();if(r.indexOf(e.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+r.join(", "));return this.transform(s=>V(s)?s:Math[e](s))}}Ln.prototype=rr.prototype;let Un=new Date(""),$i=n=>Object.prototype.toString.call(n)==="[object Date]";function nr(){return new Ae}class Ae extends L{constructor(){super({type:"date",check(e){return $i(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t,r)=>!r.spec.coerce||r.isType(e)||e===null?e:(e=bi(e),isNaN(e)?Ae.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let r;if(re.isRef(e))r=e;else{let s=this.cast(e);if(!this._typeCheck(s))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);r=s}return r}min(e,t=Ft.min){let r=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s>=this.resolve(r)}})}max(e,t=Ft.max){let r=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(s){return s<=this.resolve(r)}})}}Ae.INVALID_DATE=Un;nr.prototype=Ae.prototype;nr.INVALID_DATE=Un;function Ci(n,e=[]){let t=[],r=new Set,s=new Set(e.map(([a,o])=>`${a}-${o}`));function i(a,o){let l=ce.split(a)[0];r.add(l),s.has(`${o}-${l}`)||t.push([o,l])}for(const a of Object.keys(n)){let o=n[a];r.add(a),re.isRef(o)&&o.isSibling?i(o.path,a):de(o)&&"deps"in o&&o.deps.forEach(l=>i(l,a))}return oi.array(Array.from(r),t).reverse()}function zr(n,e){let t=1/0;return n.some((r,s)=>{var i;if((i=e.path)!=null&&i.includes(r))return t=s,!0}),t}function Mn(n){return(e,t)=>zr(n,e)-zr(n,t)}const qn=(n,e,t)=>{if(typeof n!="string")return n;let r=n;try{r=JSON.parse(n)}catch{}return t.isType(r)?r:n};function Xe(n){if("fields"in n){const e={};for(const[t,r]of Object.entries(n.fields))e[t]=Xe(r);return n.setFields(e)}if(n.type==="array"){const e=n.optional();return e.innerType&&(e.innerType=Xe(e.innerType)),e}return n.type==="tuple"?n.optional().clone({types:n.spec.types.map(Xe)}):"optional"in n?n.optional():n}const Pi=(n,e)=>{const t=[...ce.normalizePath(e)];if(t.length===1)return t[0]in n;let r=t.pop(),s=ce.getter(ce.join(t),!0)(n);return!!(s&&r in s)};let Br=n=>Object.prototype.toString.call(n)==="[object Object]";function Vr(n,e){let t=Object.keys(n.fields);return Object.keys(e).filter(r=>t.indexOf(r)===-1)}const Ri=Mn([]);function zn(n){return new sr(n)}class sr extends L{constructor(e){super({type:"object",check(t){return Br(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=Ri,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var r;let s=super._cast(e,t);if(s===void 0)return this.getDefault(t);if(!this._typeCheck(s))return s;let i=this.fields,a=(r=t.stripUnknown)!=null?r:this.spec.noUnknown,o=[].concat(this._nodes,Object.keys(s).filter(h=>!this._nodes.includes(h))),l={},u=Object.assign({},t,{parent:l,__validating:t.__validating||!1}),c=!1;for(const h of o){let p=i[h],d=h in s;if(p){let m,y=s[h];u.path=(t.path?`${t.path}.`:"")+h,p=p.resolve({value:y,context:t.context,parent:l});let g=p instanceof L?p.spec:void 0,v=g==null?void 0:g.strict;if(g!=null&&g.strip){c=c||h in s;continue}m=!t.__validating||!v?p.cast(s[h],u):s[h],m!==void 0&&(l[h]=m)}else d&&!a&&(l[h]=s[h]);(d!==h in l||l[h]!==s[h])&&(c=!0)}return c?l:s}_validate(e,t={},r,s){let{from:i=[],originalValue:a=e,recursive:o=this.spec.recursive}=t;t.from=[{schema:this,value:a},...i],t.__validating=!0,t.originalValue=a,super._validate(e,t,r,(l,u)=>{if(!o||!Br(u)){s(l,u);return}a=a||u;let c=[];for(let h of this._nodes){let p=this.fields[h];!p||re.isRef(p)||c.push(p.asNestedTest({options:t,key:h,parent:u,parentPath:t.path,originalParent:a}))}this.runTests({tests:c,value:u,originalValue:a,options:t},r,h=>{s(h.sort(this._sortErrors).concat(l),u)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),r=t.fields;for(let[s,i]of Object.entries(this.fields)){const a=r[s];r[s]=a===void 0?i:a}return t.withMutation(s=>s.setFields(r,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(r=>{var s;const i=this.fields[r];let a=e;(s=a)!=null&&s.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[r]})),t[r]=i&&"getDefault"in i?i.getDefault(a):void 0}),t}setFields(e,t){let r=this.clone();return r.fields=e,r._nodes=Ci(e,t),r._sortErrors=Mn(Object.keys(e)),t&&(r._excludedEdges=t),r}shape(e,t=[]){return this.clone().withMutation(r=>{let s=r._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),s=[...r._excludedEdges,...t]),r.setFields(Object.assign(r.fields,e),s)})}partial(){const e={};for(const[t,r]of Object.entries(this.fields))e[t]="optional"in r&&r.optional instanceof Function?r.optional():r;return this.setFields(e)}deepPartial(){return Xe(this)}pick(e){const t={};for(const r of e)this.fields[r]&&(t[r]=this.fields[r]);return this.setFields(t,this._excludedEdges.filter(([r,s])=>e.includes(r)&&e.includes(s)))}omit(e){const t=[];for(const r of Object.keys(this.fields))e.includes(r)||t.push(r);return this.pick(t)}from(e,t,r){let s=ce.getter(e,!0);return this.transform(i=>{if(!i)return i;let a=i;return Pi(i,e)&&(a=Object.assign({},i),r||delete a[e],a[t]=s(i)),a})}json(){return this.transform(qn)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||Ze.exact,test(t){if(t==null)return!0;const r=Vr(this.schema,t);return r.length===0||this.createError({params:{properties:r.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=Ze.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let r=this.test({name:"noUnknown",exclusive:!0,message:t,test(s){if(s==null)return!0;const i=Vr(this.schema,s);return!e||i.length===0||this.createError({params:{unknown:i.join(", ")}})}});return r.spec.noUnknown=e,r}unknown(e=!0,t=Ze.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const r={};for(const s of Object.keys(t))r[e(s)]=t[s];return r})}camelCase(){return this.transformKeys(Ot.camelCase)}snakeCase(){return this.transformKeys(Ot.snakeCase)}constantCase(){return this.transformKeys(e=>Ot.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);r.fields={};for(const[i,a]of Object.entries(t.fields)){var s;let o=e;(s=o)!=null&&s.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[i]})),r.fields[i]=a.describe(o)}return r}}zn.prototype=sr.prototype;function Bn(n){return new ir(n)}class ir extends L{constructor(e){super({type:"array",spec:{types:e},check(t){return Array.isArray(t)}}),this.innerType=void 0,this.innerType=e}_cast(e,t){const r=super._cast(e,t);if(!this._typeCheck(r)||!this.innerType)return r;let s=!1;const i=r.map((a,o)=>{const l=this.innerType.cast(a,Object.assign({},t,{path:`${t.path||""}[${o}]`}));return l!==a&&(s=!0),l});return s?i:r}_validate(e,t={},r,s){var i;let a=this.innerType,o=(i=t.recursive)!=null?i:this.spec.recursive;t.originalValue!=null&&t.originalValue,super._validate(e,t,r,(l,u)=>{var c;if(!o||!a||!this._typeCheck(u)){s(l,u);return}let h=new Array(u.length);for(let d=0;d<u.length;d++){var p;h[d]=a.asNestedTest({options:t,index:d,parent:u,parentPath:t.path,originalParent:(p=t.originalValue)!=null?p:e})}this.runTests({value:u,tests:h,originalValue:(c=t.originalValue)!=null?c:e,options:t},r,d=>s(d.concat(l),u))})}clone(e){const t=super.clone(e);return t.innerType=this.innerType,t}json(){return this.transform(qn)}concat(e){let t=super.concat(e);return t.innerType=this.innerType,e.innerType&&(t.innerType=t.innerType?t.innerType.concat(e.innerType):e.innerType),t}of(e){let t=this.clone();if(!de(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+J(e));return t.innerType=e,t.spec=Object.assign({},t.spec,{types:e}),t}length(e,t=Qe.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t){return t=t||Qe.min,this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t){return t=t||Qe.max,this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}ensure(){return this.default(()=>[]).transform((e,t)=>this._typeCheck(e)?e:t==null?[]:[].concat(t))}compact(e){let t=e?(r,s,i)=>!e(r,s,i):r=>!!r;return this.transform(r=>r!=null?r.filter(t):r)}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);if(t.innerType){var s;let i=e;(s=i)!=null&&s.value&&(i=Object.assign({},i,{parent:i.value,value:i.value[0]})),r.innerType=t.innerType.describe(i)}return r}}Bn.prototype=ir.prototype;function Vn(n){return new ar(n)}class ar extends L{constructor(e){super({type:"tuple",spec:{types:e},check(t){const r=this.spec.types;return Array.isArray(t)&&t.length===r.length}}),this.withMutation(()=>{this.typeError(Dn.notType)})}_cast(e,t){const{types:r}=this.spec,s=super._cast(e,t);if(!this._typeCheck(s))return s;let i=!1;const a=r.map((o,l)=>{const u=o.cast(s[l],Object.assign({},t,{path:`${t.path||""}[${l}]`}));return u!==s[l]&&(i=!0),u});return i?a:s}_validate(e,t={},r,s){let i=this.spec.types;super._validate(e,t,r,(a,o)=>{var l;if(!this._typeCheck(o)){s(a,o);return}let u=[];for(let[h,p]of i.entries()){var c;u[h]=p.asNestedTest({options:t,index:h,parent:o,parentPath:t.path,originalParent:(c=t.originalValue)!=null?c:e})}this.runTests({value:o,tests:u,originalValue:(l=t.originalValue)!=null?l:e,options:t},r,h=>s(h.concat(a),o))})}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);return r.innerType=t.spec.types.map((s,i)=>{var a;let o=e;return(a=o)!=null&&a.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[i]})),s.describe(o)}),r}}Vn.prototype=ar.prototype;function Di(n){return new it(n)}function Hr(n){try{return n()}catch(e){if(F.isError(e))return Promise.reject(e);throw e}}class it{constructor(e){this.type="lazy",this.__isYupSchema__=!0,this.spec=void 0,this._resolve=(t,r={})=>{let s=this.builder(t,r);if(!de(s))throw new TypeError("lazy() functions must return a valid schema");return this.spec.optional&&(s=s.optional()),s.resolve(r)},this.builder=e,this.spec={meta:void 0,optional:!1}}clone(e){const t=new it(this.builder);return t.spec=Object.assign({},this.spec,e),t}optionality(e){return this.clone({optional:e})}optional(){return this.optionality(!0)}resolve(e){return this._resolve(e.value,e)}cast(e,t){return this._resolve(e,t).cast(e,t)}asNestedTest(e){let{key:t,index:r,parent:s,options:i}=e,a=s[r??t];return this._resolve(a,Object.assign({},i,{value:a,parent:s})).asNestedTest(e)}validate(e,t){return Hr(()=>this._resolve(e,t).validate(e,t))}validateSync(e,t){return this._resolve(e,t).validateSync(e,t)}validateAt(e,t,r){return Hr(()=>this._resolve(t,r).validateAt(e,t,r))}validateSyncAt(e,t,r){return this._resolve(t,r).validateSyncAt(e,t,r)}isValid(e,t){try{return this._resolve(e,t).isValid(e,t)}catch(r){if(F.isError(r))return Promise.resolve(!1);throw r}}isValidSync(e,t){return this._resolve(e,t).isValidSync(e,t)}describe(e){return e?this.resolve(e).describe(e):{type:"lazy",meta:this.spec.meta,label:void 0}}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}}function Ii(n){Object.keys(n).forEach(e=>{Object.keys(n[e]).forEach(t=>{In[e][t]=n[e][t]})})}function Ni(n,e,t){if(!n||!de(n.prototype))throw new TypeError("You must provide a yup schema constructor function");if(typeof e!="string")throw new TypeError("A Method name must be provided");if(typeof t!="function")throw new TypeError("Method function must be provided");n.prototype[e]=t}const Fi=Object.freeze(Object.defineProperty({__proto__:null,ArraySchema:ir,BooleanSchema:er,DateSchema:Ae,LazySchema:it,MixedSchema:Xt,NumberSchema:rr,ObjectSchema:sr,Schema:L,StringSchema:tr,TupleSchema:ar,ValidationError:F,addMethod:Ni,array:Bn,bool:Ut,boolean:Ut,date:nr,defaultLocale:In,getIn:Qt,isSchema:de,lazy:Di,mixed:Nn,number:Ln,object:zn,printValue:J,reach:gi,ref:mi,setLocale:Ii,string:Fn,tuple:Vn},Symbol.toStringTag,{value:"Module"})),Li=Wt(Fi);var Gr;function Ui(){if(Gr)return ae;Gr=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.urlRegex=void 0,ae.validateHeader=T,ae.validateHeaderAndEvent=E;var n=t(Li);function e(b){if(typeof WeakMap!="function")return null;var x=new WeakMap,w=new WeakMap;return(e=function(O){return O?w:x})(b)}function t(b,x){if(b&&b.__esModule)return b;if(b===null||r(b)!=="object"&&typeof b!="function")return{default:b};var w=e(x);if(w&&w.has(b))return w.get(b);var S={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in b)if($!=="default"&&Object.prototype.hasOwnProperty.call(b,$)){var A=O?Object.getOwnPropertyDescriptor(b,$):null;A&&(A.get||A.set)?Object.defineProperty(S,$,A):S[$]=b[$]}return S.default=b,w&&w.set(b,S),S}function r(b){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},r(b)}function s(b,x){var w=Object.keys(b);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(b);x&&(S=S.filter(function(O){return Object.getOwnPropertyDescriptor(b,O).enumerable})),w.push.apply(w,S)}return w}function i(b){for(var x=1;x<arguments.length;x++){var w=arguments[x]!=null?arguments[x]:{};x%2?s(Object(w),!0).forEach(function(S){a(b,S,w[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(w)):s(Object(w)).forEach(function(S){Object.defineProperty(b,S,Object.getOwnPropertyDescriptor(w,S))})}return b}function a(b,x,w){return x=o(x),x in b?Object.defineProperty(b,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):b[x]=w,b}function o(b){var x=l(b,"string");return r(x)==="symbol"?x:String(x)}function l(b,x){if(r(b)!=="object"||b===null)return b;var w=b[Symbol.toPrimitive];if(w!==void 0){var S=w.call(b,x);if(r(S)!=="object")return S;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(b)}var u=ae.urlRegex=/^(?:([a-z0-9+.-]+):\/\/)(?:\S+(?::\S*)?@)?(?:(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*\.?)(?::\d{2,5})?(?:[/?#]\S*)?$/,c=function(x){var w=x.required;return n.lazy(function(S){return typeof S=="number"?n.number().integer().min(0):typeof S=="string"?n.string().required():!w&&typeof S>"u"?n.mixed().oneOf([void 0]):n.array().required().min(3).max(7).of(n.lazy(function(O,$){var A=$.parent.indexOf($.value);return[n.number().integer(),n.number().integer().min(1).max(12),n.number().integer().min(1).max(31),n.number().integer().min(0).max(23),n.number().integer().min(0).max(60),n.number().integer().min(0).max(60)][A]}))})},h=n.object().shape({before:n.boolean(),weeks:n.number(),days:n.number(),hours:n.number(),minutes:n.number(),seconds:n.number()}).noUnknown(),p=n.object().shape({name:n.string(),email:n.string().email(),rsvp:n.boolean(),dir:n.string().matches(u),partstat:n.string(),role:n.string(),cutype:n.string(),xNumGuests:n.number()}).noUnknown(),d=n.object().shape({name:n.string(),email:n.string().email(),dir:n.string(),sentBy:n.string()}).noUnknown(),m=n.object().shape({action:n.string().matches(/^(audio|display|email)$/).required(),trigger:n.mixed().required(),description:n.string(),duration:h,repeat:n.number(),attach:n.string(),attachType:n.string(),summary:n.string(),attendee:p,"x-prop":n.mixed(),"iana-prop":n.mixed()}).noUnknown(),y={productId:n.string(),method:n.string(),calName:n.string()},g=n.object().shape(y).noUnknown(),v={summary:n.string(),timestamp:c({required:!1}),title:n.string(),uid:n.string(),sequence:n.number().integer().max(2147483647),start:c({required:!0}),duration:h,startType:n.string().matches(/^(utc|local)$/),startInputType:n.string().matches(/^(utc|local)$/),startOutputType:n.string().matches(/^(utc|local)$/),end:c({required:!1}),endInputType:n.string().matches(/^(utc|local)$/),endOutputType:n.string().matches(/^(utc|local)$/),description:n.string(),url:n.string().matches(u),geo:n.object().shape({lat:n.number(),lon:n.number()}),location:n.string(),status:n.string().matches(/^(TENTATIVE|CANCELLED|CONFIRMED)$/i),categories:n.array().of(n.string()),organizer:d,attendees:n.array().of(p),alarms:n.array().of(m),recurrenceRule:n.string(),busyStatus:n.string().matches(/^(TENTATIVE|FREE|BUSY|OOF)$/i),transp:n.string().matches(/^(TRANSPARENT|OPAQUE)$/i),classification:n.string(),created:c({required:!1}),lastModified:c({required:!1}),exclusionDates:n.array().of(c({required:!0})),htmlContent:n.string()},_=n.object().shape(i(i({},y),v)).test("xor","object should have end or duration (but not both)",function(b){var x=!!b.end,w=!!b.duration;return x&&!w||!x&&w||!x&&!w}).noUnknown();function T(b){try{var x=g.validateSync(b,{abortEarly:!1,strict:!0});return{error:null,value:x}}catch(w){return{error:Object.assign({},w),value:void 0}}}function E(b){try{var x=_.validateSync(b,{abortEarly:!1,strict:!0});return{error:null,value:x}}catch(w){return{error:Object.assign({},w),value:void 0}}}return ae}var Jr;function Mi(){return Jr||(Jr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ui();Object.keys(e).forEach(function(t){t==="default"||t==="__esModule"||t in n&&n[t]===e[t]||Object.defineProperty(n,t,{enumerable:!0,get:function(){return e[t]}})})}(St)),St}var Kr;function qi(){return Kr||(Kr=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"buildEvent",{enumerable:!0,get:function(){return e.buildEvent}}),Object.defineProperty(n,"buildHeader",{enumerable:!0,get:function(){return e.buildHeader}}),Object.defineProperty(n,"formatEvent",{enumerable:!0,get:function(){return t.formatEvent}}),Object.defineProperty(n,"formatFooter",{enumerable:!0,get:function(){return t.formatFooter}}),Object.defineProperty(n,"formatHeader",{enumerable:!0,get:function(){return t.formatHeader}}),Object.defineProperty(n,"urlRegex",{enumerable:!0,get:function(){return r.urlRegex}}),Object.defineProperty(n,"validateHeader",{enumerable:!0,get:function(){return r.validateHeader}}),Object.defineProperty(n,"validateHeaderAndEvent",{enumerable:!0,get:function(){return r.validateHeaderAndEvent}});var e=Vs(),t=ri(),r=Mi()}(ot)),ot}var Wr;function zi(){if(Wr)return se;Wr=1,Object.defineProperty(se,"__esModule",{value:!0}),se.convertTimestampToArray=u,se.createEvent=c,se.createEvents=h,se.isValidURL=p;var n=qi();function e(d){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},e(d)}function t(d,m){var y=Object.keys(d);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(d);m&&(g=g.filter(function(v){return Object.getOwnPropertyDescriptor(d,v).enumerable})),y.push.apply(y,g)}return y}function r(d){for(var m=1;m<arguments.length;m++){var y=arguments[m]!=null?arguments[m]:{};m%2?t(Object(y),!0).forEach(function(g){s(d,g,y[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(y)):t(Object(y)).forEach(function(g){Object.defineProperty(d,g,Object.getOwnPropertyDescriptor(y,g))})}return d}function s(d,m,y){return m=i(m),m in d?Object.defineProperty(d,m,{value:y,enumerable:!0,configurable:!0,writable:!0}):d[m]=y,d}function i(d){var m=a(d,"string");return e(m)==="symbol"?m:String(m)}function a(d,m){if(e(d)!=="object"||d===null)return d;var y=d[Symbol.toPrimitive];if(y!==void 0){var g=y.call(d,m);if(e(g)!=="object")return g;throw new TypeError("@@toPrimitive must return a primitive value.")}return(m==="string"?String:Number)(d)}function o(d){return(0,n.validateHeader)((0,n.buildHeader)(d))}function l(d){return(0,n.validateHeaderAndEvent)(r(r({},(0,n.buildHeader)(d)),(0,n.buildEvent)(d)))}function u(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"local",y=[],g=new Date(d);return y.push(m==="local"?g.getFullYear():g.getUTCFullYear()),y.push((m==="local"?g.getMonth():g.getUTCMonth())+1),y.push(m==="local"?g.getDate():g.getUTCDate()),y.push(m==="local"?g.getHours():g.getUTCHours()),y.push(m==="local"?g.getMinutes():g.getUTCMinutes()),y}function c(d,m){return h([d],m)}function h(d,m,y){var g=e(m)==="object"?m:{},v=arguments.length===3?y:typeof m=="function"?m:null,_=function(){if(!d)return{error:new Error("one argument is required"),value:null};var b=d.length===0?o(g):l(r(r({},d[0]),g)),x=b.error,w=b.value;if(x)return{error:x,value:null};var S="";S+=(0,n.formatHeader)(w);for(var O=0;O<d.length;O++){var $=l(d[O]),A=$.error,U=$.value;if(A)return{error:A,value:null};S+=(0,n.formatEvent)(U)}return S+=(0,n.formatFooter)(),{error:null,value:S}},T;try{T=_()}catch(E){T={error:E,value:null}}return v?v(T.error,T.value):T}function p(d){return n.urlRegex.test(d)}return se}var Bi=zi();function Hn(n){return n.flatMap(e=>{const t=new Date(e.startTime),r=[],s=new Date(t.getTime()+e.duration*24*60*60*1e3);let i=new Date(t),a=1,o=i.getDate();for(;i<s;){const l=i.toLocaleDateString("en-US",{weekday:"long",day:"2-digit",month:"long",year:"numeric"});let u=e.duration>1?`📆 Treatment day: ${a} of ${e.duration}`:`📆 Total duration: ${e.duration} day`;const c=new Date(i.getTime());c.setHours(i.getHours()+1,i.getMinutes()),r.push({start:[i.getFullYear(),i.getMonth()+1,i.getDate(),i.getHours(),i.getMinutes()],end:[c.getFullYear(),c.getMonth()+1,c.getDate(),c.getHours(),c.getMinutes()],title:`💊 ${e.name} - every ${e.interval}h`,description:`📅 Date: ${l}
⏰ Time: ${i.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1})}
💊 Medication: ${e.name}
⏳ Interval: Every ${e.interval} hours
${u}
✅ Remember to take it on time.`,productId:"medicine-calendar/ics",calName:"Medicine Calendar",status:"CONFIRMED",busyStatus:"FREE",alarms:[{action:"display",description:"It's time for your medication!",trigger:{minutes:10,before:!0}}]}),i.setHours(i.getHours()+e.interval),i.getDate()!==o&&(a++,o=i.getDate())}if(e.interval>24){const l=new Date(s);l.setHours(t.getHours(),t.getMinutes(),0,0);const u=new Date(l.getTime());u.setHours(l.getHours()+1,l.getMinutes()),r.push({start:[l.getFullYear(),l.getMonth()+1,l.getDate(),l.getHours(),l.getMinutes()],end:[u.getFullYear(),u.getMonth()+1,u.getDate(),u.getHours(),u.getMinutes()],title:`💊 ${e.name} - Final Dose`,description:`📅 Date: ${l.toLocaleDateString("en-US",{weekday:"long",day:"2-digit",month:"long",year:"numeric"})}
⏰ Time: ${l.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1})}
💊 Medication: ${e.name}
⏳ Final scheduled dose.
✅ Ensure you complete your treatment.`,productId:"medicine-calendar/ics",calName:"Medicine Calendar",status:"CONFIRMED",busyStatus:"FREE",alarms:[{action:"display",description:"It's time for your medication!",trigger:{minutes:10,before:!0}}]})}return r})}function Gn(n){return new Promise((e,t)=>{if(!n||n.length===0){t(new Error("No events provided for calendar"));return}Bi.createEvents(n,(r,s)=>{if(r){console.error("Error generating .ics file:",r),t(r);return}if(!s){console.error("No ICS content generated"),t(new Error("Failed to generate ICS content"));return}const i=new Blob([s],{type:"text/calendar;charset=utf-8"});e(i)})})}function Jn(){return`medications_${new Date().toISOString().replace(/[:.-]/g,"")}.ics`}function Vi(n){const e=JSON.stringify(n.map(r=>({name:r.name,interval:r.interval,duration:r.duration,startTime:r.startTime})));let t=0;if(e.length===0)return t.toString();for(let r=0;r<e.length;r++){const s=e.charCodeAt(r);t=(t<<5)-t+s,t=t&t}return t.toString()}const Hi=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Oe(async()=>{const{default:r}=await Promise.resolve().then(()=>$e);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class or extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Gi extends or{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ji extends or{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ki extends or{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var qt;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(qt||(qt={}));var Wi=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};class Yi{constructor(e,{headers:t={},customFetch:r,region:s=qt.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=Hi(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Wi(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let u;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:u}).catch(m=>{throw new Gi(m)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new Ji(c);if(!c.ok)throw new Ki(c);let p=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),d;return p==="application/json"?d=yield c.json():p==="application/octet-stream"?d=yield c.blob():p==="text/event-stream"?d=c:p==="multipart/form-data"?d=yield c.formData():d=yield c.text(),{data:d,error:null}}catch(s){return{data:null,error:s}}})}}var I={},ge={},ye={},ve={},be={},_e={},Zi=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ke=Zi();const Qi=ke.fetch,Kn=ke.fetch.bind(ke),Wn=ke.Headers,Xi=ke.Request,ea=ke.Response,$e=Object.freeze(Object.defineProperty({__proto__:null,Headers:Wn,Request:Xi,Response:ea,default:Kn,fetch:Qi},Symbol.toStringTag,{value:"Module"})),ta=Wt($e);var Ge={},Yr;function Yn(){if(Yr)return Ge;Yr=1,Object.defineProperty(Ge,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Ge.default=n,Ge}var Zr;function Zn(){if(Zr)return _e;Zr=1;var n=_e&&_e.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(_e,"__esModule",{value:!0});const e=n(ta),t=n(Yn());class r{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,a){return this.headers=Object.assign({},this.headers),this.headers[i]=a,this}then(i,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{var c,h,p;let d=null,m=null,y=null,g=u.status,v=u.statusText;if(u.ok){if(this.method!=="HEAD"){const b=await u.text();b===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=b:m=JSON.parse(b))}const T=(c=this.headers.Prefer)===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),E=(h=u.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");T&&E&&E.length>1&&(y=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(d={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,y=null,g=406,v="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const T=await u.text();try{d=JSON.parse(T),Array.isArray(d)&&u.status===404&&(m=[],d=null,g=200,v="OK")}catch{u.status===404&&T===""?(g=204,v="No Content"):d={message:T}}if(d&&this.isMaybeSingle&&(!((p=d==null?void 0:d.details)===null||p===void 0)&&p.includes("0 rows"))&&(d=null,g=200,v="OK"),d&&this.shouldThrowOnError)throw new t.default(d)}return{error:d,data:m,count:y,status:g,statusText:v}});return this.shouldThrowOnError||(l=l.catch(u=>{var c,h,p;return{error:{message:`${(c=u==null?void 0:u.name)!==null&&c!==void 0?c:"FetchError"}: ${u==null?void 0:u.message}`,details:`${(h=u==null?void 0:u.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(p=u==null?void 0:u.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,a)}returns(){return this}overrideTypes(){return this}}return _e.default=r,_e}var Qr;function Qn(){if(Qr)return be;Qr=1;var n=be&&be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(be,"__esModule",{value:!0});const e=n(Zn());class t extends e.default{select(s){let i=!1;const a=(s??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:i=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const u=l?`${l}.order`:"order",c=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${c?`${c},`:""}${s}.${i?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:a=i}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${s}`),this}range(s,i,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(u,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:i=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:u="text"}={}){var c;const h=[s?"analyze":null,i?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),p=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${u}; for="${p}"; options=${h};`,u==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return be.default=t,be}var Xr;function lr(){if(Xr)return ve;Xr=1;var n=ve&&ve.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ve,"__esModule",{value:!0});const e=n(Qn());class t extends e.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const a=Array.from(new Set(i)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(s,`in.(${a})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:a,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const u=a===void 0?"":`(${a})`;return this.url.searchParams.append(s,`${l}fts${u}.${i}`),this}match(s){return Object.entries(s).forEach(([i,a])=>{this.url.searchParams.append(i,`eq.${a}`)}),this}not(s,i,a){return this.url.searchParams.append(s,`not.${i}.${a}`),this}or(s,{foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.or`:"or";return this.url.searchParams.append(o,`(${s})`),this}filter(s,i,a){return this.url.searchParams.append(s,`${i}.${a}`),this}}return ve.default=t,ve}var en;function Xn(){if(en)return ye;en=1;var n=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ye,"__esModule",{value:!0});const e=n(lr());class t{constructor(s,{headers:i={},schema:a,fetch:o}){this.url=s,this.headers=i,this.schema=a,this.fetch=o}select(s,{head:i=!1,count:a}={}){const o=i?"HEAD":"GET";let l=!1;const u=(s??"*").split("").map(c=>/\s/.test(c)&&!l?"":(c==='"'&&(l=!l),c)).join("");return this.url.searchParams.set("select",u),a&&(this.headers.Prefer=`count=${a}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:i,defaultToNull:a=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(s)){const u=s.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(u.length>0){const c=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:i,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){const u="POST",c=[`resolution=${a?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&c.push(this.headers.Prefer),o&&c.push(`count=${o}`),l||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(s)){const h=s.reduce((p,d)=>p.concat(Object.keys(d)),[]);if(h.length>0){const p=[...new Set(h)].map(d=>`"${d}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:i}={}){const a="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),this.headers.Prefer=o.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const i="DELETE",a=[];return s&&a.push(`count=${s}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return ye.default=t,ye}var De={},Ie={},tn;function ra(){return tn||(tn=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.version=void 0,Ie.version="0.0.0-automated"),Ie}var rn;function na(){if(rn)return De;rn=1,Object.defineProperty(De,"__esModule",{value:!0}),De.DEFAULT_HEADERS=void 0;const n=ra();return De.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},De}var nn;function sa(){if(nn)return ge;nn=1;var n=ge&&ge.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ge,"__esModule",{value:!0});const e=n(Xn()),t=n(lr()),r=na();class s{constructor(a,{headers:o={},schema:l,fetch:u}={}){this.url=a,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=u}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new s(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:u=!1,count:c}={}){let h;const p=new URL(`${this.url}/rpc/${a}`);let d;l||u?(h=l?"HEAD":"GET",Object.entries(o).filter(([y,g])=>g!==void 0).map(([y,g])=>[y,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([y,g])=>{p.searchParams.append(y,g)})):(h="POST",d=o);const m=Object.assign({},this.headers);return c&&(m.Prefer=`count=${c}`),new t.default({method:h,url:p,headers:m,schema:this.schemaName,body:d,fetch:this.fetch,allowEmpty:!1})}}return ge.default=s,ge}var sn;function ia(){if(sn)return I;sn=1;var n=I&&I.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(I,"__esModule",{value:!0}),I.PostgrestError=I.PostgrestBuilder=I.PostgrestTransformBuilder=I.PostgrestFilterBuilder=I.PostgrestQueryBuilder=I.PostgrestClient=void 0;const e=n(sa());I.PostgrestClient=e.default;const t=n(Xn());I.PostgrestQueryBuilder=t.default;const r=n(lr());I.PostgrestFilterBuilder=r.default;const s=n(Qn());I.PostgrestTransformBuilder=s.default;const i=n(Zn());I.PostgrestBuilder=i.default;const a=n(Yn());return I.PostgrestError=a.default,I.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:i.default,PostgrestError:a.default},I}var aa=ia();const oa=_n(aa),{PostgrestClient:la,PostgrestQueryBuilder:el,PostgrestFilterBuilder:tl,PostgrestTransformBuilder:rl,PostgrestBuilder:nl,PostgrestError:sl}=oa,ua="2.11.2",ca={"X-Client-Info":`realtime-js/${ua}`},da="1.0.0",es=1e4,ha=1e3;var je;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(je||(je={}));var z;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(z||(z={}));var B;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(B||(B={}));var zt;(function(n){n.websocket="websocket"})(zt||(zt={}));var ue;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(ue||(ue={}));class fa{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+s));a=a+s;const l=r.decode(e.slice(a,a+i));a=a+i;const u=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class ts{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var P;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(P||(P={}));const an=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,a)=>(i[a]=pa(a,n,e,s),i),{})},pa=(n,e,t,r)=>{const s=e.find(o=>o.name===n),i=s==null?void 0:s.type,a=t[n];return i&&!r.includes(i)?rs(i,a):Bt(a)},rs=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return va(e,t)}switch(n){case P.bool:return ma(e);case P.float4:case P.float8:case P.int2:case P.int4:case P.int8:case P.numeric:case P.oid:return ga(e);case P.json:case P.jsonb:return ya(e);case P.timestamp:return ba(e);case P.abstime:case P.date:case P.daterange:case P.int4range:case P.int8range:case P.money:case P.reltime:case P.text:case P.time:case P.timestamptz:case P.timetz:case P.tsrange:case P.tstzrange:return Bt(e);default:return Bt(e)}},Bt=n=>n,ma=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},ga=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},ya=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},va=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const a=n.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>rs(e,o))}return n},ba=n=>typeof n=="string"?n.replace(" ","T"):n,ns=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class kt{constructor(e,t,r={},s=es){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var on;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(on||(on={}));class Le{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Le.syncState(this.state,s,i,a),this.pendingDiffs.forEach(l=>{this.state=Le.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Le.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(u,c)=>{a[u]||(l[u]=c)}),this.map(a,(u,c)=>{const h=i[u];if(h){const p=c.map(g=>g.presence_ref),d=h.map(g=>g.presence_ref),m=c.filter(g=>d.indexOf(g.presence_ref)<0),y=h.filter(g=>p.indexOf(g.presence_ref)<0);m.length>0&&(o[u]=m),y.length>0&&(l[u]=y)}else o[u]=c}),this.syncDiff(i,{joins:o,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(o,l)=>{var u;const c=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),c.length>0){const h=e[o].map(d=>d.presence_ref),p=c.filter(d=>h.indexOf(d.presence_ref)<0);e[o].unshift(...p)}r(o,c,l)}),this.map(a,(o,l)=>{let u=e[o];if(!u)return;const c=l.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[o]=u,s(o,u,l),u.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ln;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(ln||(ln={}));var un;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(un||(un={}));var W;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(W||(W={}));class ur{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=z.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new kt(this,B.join,this.params,this.timeout),this.rejoinTimer=new ts(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=z.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=z.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this._on(B.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Le(this),this.broadcastEndpointURL=ns(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(c=>e==null?void 0:e(W.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(W.CLOSED));const l={},u={broadcast:i,presence:a,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:c})=>{var h;if(this.socket.setAuth(),c===void 0){e==null||e(W.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,d=(h=p==null?void 0:p.length)!==null&&h!==void 0?h:0,m=[];for(let y=0;y<d;y++){const g=p[y],{filter:{event:v,schema:_,table:T,filter:E}}=g,b=c&&c[y];if(b&&b.event===v&&b.schema===_&&b.table===T&&b.filter===E)m.push(Object.assign(Object.assign({},g),{id:b.id}));else{this.unsubscribe(),e==null||e(W.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(W.SUBSCRIBED);return}}).receive("error",c=>{e==null||e(W.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(W.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=z.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(B.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const s=new kt(this,B.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new kt(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:c}=B;if(r&&[o,l,u,c].indexOf(a)>=0&&r!==this._joinRef())return;let p=this._onMessage(a,t,r);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(d=>{var m,y,g;return((m=d.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(y=d.filter)===null||y===void 0?void 0:y.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(d=>d.callback(p,r)):(i=this.bindings[a])===null||i===void 0||i.filter(d=>{var m,y,g,v,_,T;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in d){const E=d.id,b=(m=d.filter)===null||m===void 0?void 0:m.event;return E&&((y=t.ids)===null||y===void 0?void 0:y.includes(E))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((g=t.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const E=(_=(v=d==null?void 0:d.filter)===null||v===void 0?void 0:v.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return E==="*"||E===((T=t==null?void 0:t.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===a}).map(d=>{if(typeof p=="object"&&"ids"in p){const m=p.data,{schema:y,table:g,commit_timestamp:v,type:_,errors:T}=m;p=Object.assign(Object.assign({},{schema:y,table:g,commit_timestamp:v,eventType:_,new:{},old:{},errors:T}),this._getPayloadRecords(m))}d.callback(p,r)})}_isClosed(){return this.state===z.closed}_isJoined(){return this.state===z.joined}_isJoining(){return this.state===z.joining}_isLeaving(){return this.state===z.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&ur.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(B.close,{},e)}_onError(e){this._on(B.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=z.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=an(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=an(e.columns,e.old_record)),t}}const _a=()=>{},wa=typeof WebSocket<"u",xa=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ta{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=ca,this.params={},this.timeout=es,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=_a,this.conn=null,this.sendBuffer=[],this.serializer=new fa,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Oe(async()=>{const{default:l}=await Promise.resolve().then(()=>$e);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${zt.websocket}`,this.httpEndpoint=ns(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ts(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(wa){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Sa(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Oe(async()=>{const{default:e}=await import("./browser-BPXGE2oM.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1,2])).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:da}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case je.connecting:return ue.Connecting;case je.open:return ue.Open;case je.closing:return ue.Closing;default:return ue.Closed}}isConnected(){return this.connectionState()===ue.Open}channel(e,t={config:{}}){const r=new ur(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:s,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let r=null;try{r=JSON.parse(atob(t.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=t,this.channels.forEach(s=>{t&&s.updateJoinPayload({access_token:t}),s.joinedOnce&&s._isJoined()&&s._push(B.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(ha,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:a}=t;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(r)).forEach(o=>o._trigger(s,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(B.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([xa],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Sa{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=je.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class cr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function N(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Ea extends cr{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Vt extends cr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var ja=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};const ss=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Oe(async()=>{const{default:r}=await Promise.resolve().then(()=>$e);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Oa=()=>ja(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Oe(()=>Promise.resolve().then(()=>$e),void 0)).Response:Response}),Ht=n=>{if(Array.isArray(n))return n.map(t=>Ht(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Ht(r)}),e};var he=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};const At=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ka=(n,e,t)=>he(void 0,void 0,void 0,function*(){const r=yield Oa();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(s=>{e(new Ea(At(s),n.status||500))}).catch(s=>{e(new Vt(At(s),s))}):e(new Vt(At(n),n))}),Aa=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),t))};function ze(n,e,t,r,s,i){return he(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,Aa(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>ka(l,o,r))})})}function rt(n,e,t,r){return he(this,void 0,void 0,function*(){return ze(n,"GET",e,t,r)})}function X(n,e,t,r,s){return he(this,void 0,void 0,function*(){return ze(n,"POST",e,r,s,t)})}function $a(n,e,t,r,s){return he(this,void 0,void 0,function*(){return ze(n,"PUT",e,r,s,t)})}function Ca(n,e,t,r){return he(this,void 0,void 0,function*(){return ze(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function is(n,e,t,r,s){return he(this,void 0,void 0,function*(){return ze(n,"DELETE",e,r,s,t)})}var M=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};const Pa={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},cn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ra{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=ss(s)}uploadOrUpdate(e,t,r,s){return M(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},cn),s);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const u=this._removeEmptyFolders(t),c=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),p=yield h.json();return h.ok?{data:{path:u,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(N(i))return{data:null,error:i};throw i}})}upload(e,t,r){return M(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return M(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:cn.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:c}),p=yield h.json();return h.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(N(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return M(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield X(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new cr("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}update(e,t,r){return M(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return M(this,void 0,void 0,function*(){try{return{data:yield X(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}copy(e,t,r){return M(this,void 0,void 0,function*(){try{return{data:{path:(yield X(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return M(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield X(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return M(this,void 0,void 0,function*(){try{const s=yield X(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}download(e,t){return M(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield rt(this.fetch,`${this.url}/${s}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(N(o))return{data:null,error:o};throw o}})}info(e){return M(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield rt(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ht(r),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}exists(e){return M(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Ca(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(N(r)&&r instanceof Vt){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${u}`)}}}remove(e){return M(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(N(t))return{data:null,error:t};throw t}})}list(e,t,r){return M(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Pa),t),{prefix:e||""});return{data:yield X(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Da="2.7.1",Ia={"X-Client-Info":`storage-js/${Da}`};var we=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};class Na{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Ia),t),this.fetch=ss(r)}listBuckets(){return we(this,void 0,void 0,function*(){try{return{data:yield rt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}getBucket(e){return we(this,void 0,void 0,function*(){try{return{data:yield rt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(N(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return we(this,void 0,void 0,function*(){try{return{data:yield X(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return we(this,void 0,void 0,function*(){try{return{data:yield $a(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}emptyBucket(e){return we(this,void 0,void 0,function*(){try{return{data:yield X(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(N(t))return{data:null,error:t};throw t}})}deleteBucket(e){return we(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(N(t))return{data:null,error:t};throw t}})}}class Fa extends Na{constructor(e,t={},r){super(e,t,r)}from(e){return new Ra(this.url,this.headers,e,this.fetch)}}const La="2.49.1";let Ne="";typeof Deno<"u"?Ne="deno":typeof document<"u"?Ne="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ne="react-native":Ne="node";const Ua={"X-Client-Info":`supabase-js-${Ne}/${La}`},Ma={headers:Ua},qa={schema:"public"},za={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ba={};var Va=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};const Ha=n=>{let e;return n?e=n:typeof fetch>"u"?e=Kn:e=fetch,(...t)=>e(...t)},Ga=()=>typeof Headers>"u"?Wn:Headers,Ja=(n,e,t)=>{const r=Ha(t),s=Ga();return(i,a)=>Va(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:n;let u=new s(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},a),{headers:u}))})};var Ka=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};function Wa(n){return n.replace(/\/$/,"")}function Ya(n,e){const{db:t,auth:r,realtime:s,global:i}=n,{db:a,auth:o,realtime:l,global:u}=e,c={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},u),i),accessToken:()=>Ka(this,void 0,void 0,function*(){return""})};return n.accessToken?c.accessToken=n.accessToken:delete c.accessToken,c}const as="2.68.0",Se=30*1e3,Gt=3,$t=Gt*Se,Za="http://localhost:9999",Qa="supabase.auth.token",Xa={"X-Client-Info":`gotrue-js/${as}`},Jt="X-Supabase-Api-Version",os={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function eo(n){return Math.round(Date.now()/1e3)+n}function to(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const H=()=>typeof window<"u"&&typeof document<"u",oe={tested:!1,writable:!1},Ue=()=>{if(!H())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(oe.tested)return oe.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),oe.tested=!0,oe.writable=!0}catch{oe.tested=!0,oe.writable=!1}return oe.writable};function ro(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const ls=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Oe(async()=>{const{default:r}=await Promise.resolve().then(()=>$e);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},no=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",us=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Je=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ke=async(n,e)=>{await n.removeItem(e)};function so(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,s,i,a,o,l,u,c=0;for(n=n.replace("-","+").replace("_","/");c<n.length;)a=e.indexOf(n.charAt(c++)),o=e.indexOf(n.charAt(c++)),l=e.indexOf(n.charAt(c++)),u=e.indexOf(n.charAt(c++)),r=a<<2|o>>4,s=(o&15)<<4|l>>2,i=(l&3)<<6|u,t=t+String.fromCharCode(r),l!=64&&s!=0&&(t=t+String.fromCharCode(s)),u!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class at{constructor(){this.promise=new at.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}at.promiseConstructor=Promise;function dn(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(so(r))}async function io(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function ao(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await n(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function oo(n){return("0"+n.toString(16)).substr(-2)}function lo(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,oo).join("")}async function uo(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}function co(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ho(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await uo(n);return co(t)}async function xe(n,e,t=!1){const r=lo();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await us(n,`${e}-code-verifier`,s);const i=await ho(r);return[i,r===i?"plain":"s256"]}const fo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function po(n){const e=n.headers.get(Jt);if(!e||!e.match(fo))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class dr extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function j(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class mo extends dr{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function go(n){return j(n)&&n.name==="AuthApiError"}class cs extends dr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class fe extends dr{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class Z extends fe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function yo(n){return j(n)&&n.name==="AuthSessionMissingError"}class Ct extends fe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class We extends fe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ye extends fe{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function vo(n){return j(n)&&n.name==="AuthImplicitGrantRedirectError"}class hn extends fe{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Kt extends fe{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Pt(n){return j(n)&&n.name==="AuthRetryableFetchError"}class fn extends fe{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var bo=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const le=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),_o=[502,503,504];async function pn(n){var e;if(!no(n))throw new Kt(le(n),0);if(_o.includes(n.status))throw new Kt(le(n),n.status);let t;try{t=await n.json()}catch(i){throw new cs(le(i),i)}let r;const s=po(n);if(s&&s.getTime()>=os["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new fn(le(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Z}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new fn(le(t),n.status,t.weak_password.reasons);throw new mo(le(t),n.status||500,r)}const wo=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function k(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Jt]||(i[Jt]=os["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await xo(n,e,t+o,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function xo(n,e,t,r,s,i){const a=wo(e,r,s,i);let o;try{o=await n(t,Object.assign({},a))}catch(l){throw console.error(l),new Kt(le(l),0)}if(o.ok||await pn(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await pn(l)}}function Q(n){var e;let t=null;jo(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=eo(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function mn(n){const e=Q(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function ee(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function To(n){return{data:n,error:null}}function So(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,a=bo(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Eo(n){return n}function jo(n){return n.access_token&&n.refresh_token&&n.expires_in}var Oo=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class ko{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=ls(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await k(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(j(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await k(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ee})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Oo(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await k(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:So,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(j(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await k(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ee})}catch(t){if(j(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},c=await k(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Eo});if(c.error)throw c.error;const h=await c.json(),p=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(m=>{const y=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);u[`${g}Page`]=y}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(j(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await k(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ee})}catch(t){if(j(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await k(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ee})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await k(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ee})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await k(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(j(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await k(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(j(t))return{data:null,error:t};throw t}}}const Ao={getItem:n=>Ue()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{Ue()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{Ue()&&globalThis.localStorage.removeItem(n)}};function gn(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function $o(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Te={debug:!!(globalThis&&Ue()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ds extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Co extends ds{}async function Po(n,e,t){Te.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Te.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Te.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Te.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Te.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Co(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Te.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}$o();const Ro={url:Za,storageKey:Qa,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Xa,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function yn(n,e,t){return await t()}class qe{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=qe.nextInstanceID,qe.nextInstanceID+=1,this.instanceID>0&&H()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Ro),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new ko({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=ls(s.fetch),this.lock=s.lock||yn,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:H()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Po:this.lock=yn,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Ue()?this.storage=Ao:(this.memoryStorage={},this.storage=gn(this.memoryStorage)):(this.memoryStorage={},this.storage=gn(this.memoryStorage)),H()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${as}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=ro(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),H()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),vo(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return j(t)?{error:t}:{error:new cs("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Q}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(j(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:c,password:h,options:p}=e;let d=null,m=null;this.flowType==="pkce"&&([d,m]=await xe(this.storage,this.storageKey)),i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:c,password:h,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:d,code_challenge_method:m},xform:Q})}else if("phone"in e){const{phone:c,password:h,options:p}=e;i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(s=p==null?void 0:p.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Q})}else throw new We("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(j(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:mn})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:mn})}else throw new We("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Ct}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Je(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:i,error:a}=await k(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Q});if(await Ke(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Ct}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(j(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:a}=e,o=await k(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Q}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ct}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,a;try{if("email"in e){const{email:o,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await xe(this.storage,this.storageKey));const{error:h}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:c}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new We("You must provide either an email or phone number.")}catch(o){if(j(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await k(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Q});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(j(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await xe(this.storage,this.storageKey)),await k(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:To})}catch(i){if(j(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Z;const{error:s}=await k(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(j(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:a}=await k(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:a,error:o}=await k(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new We("You must provide either an email or phone number and a type")}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Je(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<$t:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,c)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,c))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ee}):await this._useSession(async t=>{var r,s,i;const{data:a,error:o}=t;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Z}:await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:ee})})}catch(t){if(j(t))return yo(t)&&(await this._removeSession(),await Ke(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new Z;const a=s.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await xe(this.storage,this.storageKey));const{data:u,error:c}=await k(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:ee});if(c)throw c;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return dn(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Z;const t=Date.now()/1e3;let r=t,s=!0,i=null;const a=dn(e.access_token);if(a.exp&&(r=a.exp,s=r<=t),s){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(j(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Z;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!H())throw new Ye("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ye(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new hn("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ye("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new hn("No code detected.");const{data:_,error:T}=await this._exchangeCodeForSession(e.code);if(T)throw T;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=e;if(!i||!o||!a||!u)throw new Ye("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(o);let p=c+h;l&&(p=parseInt(l));const d=p-c;d*1e3<=Se&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${h}s`);const m=p-h;c-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,p,c):c-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,p,c);const{data:y,error:g}=await this._getUser(i);if(g)throw g;const v={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:p,refresh_token:a,token_type:u,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(r){if(j(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Je(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const a=(r=s.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(go(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Ke(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=to(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:a}=t;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await xe(this.storage,this.storageKey,!0));try{return await k(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(j(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(j(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var a,o,l,u,c;const{data:h,error:p}=i;if(p)throw p;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await k(this.fetch,"GET",d,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return H()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(j(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:a}=t;if(a)throw a;return await k(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(j(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await ao(async s=>(s>0&&await io(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await k(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Q})),(s,i)=>{const a=200*Math.pow(2,s);return i&&Pt(i)&&Date.now()+a-r<Se})}catch(r){if(this._debug(t,"error",r),j(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),H()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Je(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const s=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<$t;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${$t}s`),s){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),Pt(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Z;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new at;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Z;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),j(i)){const a={session:null,error:i};return Pt(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await us(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Ke(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&H()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Se);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/Se);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Se}ms, refresh threshold is ${Gt} ticks`),s<=Gt&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ds)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!H()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,a]=await xe(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await k(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(j(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await k(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(j(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(j(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(j(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(s.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const c=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}}qe.nextInstanceID=0;const Do=qe;class Io extends Do{constructor(e){super(e)}}var No=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};class Fo{constructor(e,t,r){var s,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=Wa(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:qa,realtime:Ba,auth:Object.assign(Object.assign({},za),{storageKey:l}),global:Ma},c=Ya(r??{},u);this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=c.global.headers)!==null&&i!==void 0?i:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=c.auth)!==null&&a!==void 0?a:{},this.headers,c.global.fetch),this.fetch=Ja(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new la(`${o}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new Yi(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Fa(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return No(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:a,lock:o,debug:l},u,c){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Io({url:this.authUrl,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:a,lock:o,debug:l,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Ta(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Lo=(n,e,t)=>new Fo(n,e,t),Uo="https://rjgbqfrmavdsfmsnpsoe.supabase.co",Mo="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJqZ2JxZnJtYXZkc2Ztc25wc29lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA1NzQwOTMsImV4cCI6MjA1NjE1MDA5M30.4Btt15e6vqM1pIF4Y488ED_sjqM1shDnr0nHyJF1X-A",hs=Lo(Uo,Mo);async function qo(n,e,t){const{data:r,error:s}=await hs.storage.from(e).upload(t,n);if(s)throw console.error("Error uploading file:",s),s;return console.log("File uploaded successfully:",r),r}async function zo(n,e){const{data:t}=hs.storage.from(n).getPublicUrl(e);if(!t||!t.publicUrl)throw new Error("Failed to get public URL");return t.publicUrl.replace("https://","webcal://")}async function vn(n){if(!n){console.error("Invalid URL for download");return}window.location.href=n}let Fe={medicinesHash:null,fileUrl:null,fileName:null};async function Bo(n){try{if(!n||n.length===0)throw new Error("No medicines provided for calendar export");const e=Vi(n);if(e===Fe.medicinesHash&&Fe.fileUrl){console.log("Using cached calendar file - no changes detected"),await vn(Fe.fileUrl);return}const t=Hn(n);if(!t||t.length===0)throw new Error("No calendar events generated from medicines");console.log(`Generated ${t.length} calendar events`);const r=await Gn(t);if(!r||r.size===0)throw new Error("Generated ICS file is empty");console.log(`Local ICS file created with size: ${(r.size/1024).toFixed(2)} KB`);const s=Jn(),i=new File([r],s,{type:"text/calendar"}),a=await qo(i,"medicine-calendar",`calendars/${i.name}`),o=await zo("medicine-calendar",`calendars/${i.name}`);o?(await vn(o),Fe={medicinesHash:e,fileUrl:o,fileName:s}):console.error("Error: File URL is undefined")}catch(e){throw console.error("Error exporting calendar:",e),e}}async function Vo(n){try{if(!n||n.length===0)throw new Error("No medicines provided for local calendar export");const e=Hn(n);if(!e||e.length===0)throw new Error("No calendar events generated from medicines");console.log(`Generated ${e.length} calendar events for local download`);const t=await Gn(e);if(!t||t.size===0)throw new Error("Generated ICS file is empty");console.log(`Local ICS file created with size: ${(t.size/1024).toFixed(2)} KB`);const r=Jn(),s=URL.createObjectURL(t),i=document.createElement("a");i.href=s,i.download=r,document.body.appendChild(i),i.click(),setTimeout(()=>{document.body.removeChild(i),URL.revokeObjectURL(s)},100)}catch(e){throw console.error("Error during local calendar export:",e),e}}function Ho(){Fe={medicinesHash:null,fileUrl:null,fileName:null}}function bn({icon:n,title:e,description:t,onClick:r,isLoading:s,isDisabled:i,colorClass:a,iconBgClass:o}){return f.jsxs(R.button,{className:`flex items-center px-6 py-4 rounded-lg border transition-all ${i?"bg-gray-800/30 border-gray-700/30 cursor-not-allowed text-gray-500":`bg-gradient-to-br ${a} shadow-lg text-white cursor-pointer`}`,onClick:r,disabled:i||s,whileHover:i?{}:{scale:1.02},whileTap:i?{}:{scale:.98},children:[f.jsx("div",{className:`${i?"":`${o} p-2 rounded-full`} mr-4`,children:s?f.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):f.jsx("div",{className:"text-2xl",children:n})}),f.jsxs("div",{className:"text-left",children:[f.jsx("div",{className:"font-medium",children:e}),f.jsx("div",{className:"text-xs opacity-80",children:t})]})]})}function Go(){return f.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"flex flex-wrap justify-center gap-4 mb-6",children:[f.jsxs("div",{className:"flex items-center px-3 py-2 bg-gradient-to-r from-blue-900/20 to-blue-800/20 rounded-full border border-blue-500/20",children:[f.jsx(xn,{className:"text-blue-400 mr-2"}),f.jsx("span",{className:"text-sm text-blue-300",children:"iPhone: Subscribe"})]}),f.jsxs("div",{className:"flex items-center px-3 py-2 bg-gradient-to-r from-purple-900/20 to-purple-800/20 rounded-full border border-purple-500/20",children:[f.jsx(Tn,{className:"text-purple-400 mr-2"}),f.jsx("span",{className:"text-sm text-purple-300",children:"Android: Download"})]})]})}function Jo(){const[n,e]=D.useState(!1);return f.jsxs("div",{className:"relative inline-block",children:[f.jsxs("span",{className:"text-sm text-blue-400 flex items-center justify-center cursor-pointer hover:text-blue-300 transition-colors duration-200",onMouseEnter:()=>e(!0),onMouseLeave:()=>e(!1),onClick:()=>e(!n),children:[f.jsx(nt,{className:"mr-1"})," How does this work?"]}),f.jsx(te,{children:n&&f.jsxs(R.div,{className:"absolute z-10 bg-gradient-to-b from-[#2a2a2a] to-[#252525] p-4 rounded-md shadow-lg w-72 sm:w-80 text-left mt-2 left-1/2 transform -translate-x-1/2 border border-gray-700",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[f.jsxs("p",{className:"text-xs mb-2",children:[f.jsx("strong",{className:"text-blue-400",children:"Subscribe:"})," Adds events to your online calendar (Google Calendar, Apple Calendar, etc.)"]}),f.jsxs("p",{className:"text-xs mb-3",children:[f.jsx("strong",{className:"text-purple-400",children:"Download:"})," Saves an ICS file that you can import into any calendar app."]}),f.jsxs("div",{className:"pt-2 border-t border-gray-700",children:[f.jsx("p",{className:"text-xs font-medium mb-1 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"Recommended by device:"}),f.jsxs("div",{className:"flex items-center mb-1",children:[f.jsx(xn,{className:"text-blue-400 mr-2"}),f.jsxs("p",{className:"text-xs",children:[f.jsx("strong",{children:"iPhone/iOS:"})," Subscription works best"]})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(Tn,{className:"text-purple-400 mr-2"}),f.jsxs("p",{className:"text-xs",children:[f.jsx("strong",{children:"Android:"})," Download is recommended"]})]})]})]})})]})}function Ko({exportStatus:n,isDisabled:e}){return f.jsxs(f.Fragment,{children:[n.error&&f.jsx(R.div,{className:"mt-6 bg-gradient-to-r from-red-900/30 to-red-800/30 border border-red-500/50 text-red-200 px-4 py-3 rounded-md text-center text-sm",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:n.error}),n.success&&f.jsxs(R.div,{className:"mt-6 bg-gradient-to-r from-green-900/30 to-green-800/30 border border-green-500/50 text-green-200 px-4 py-3 rounded-md flex items-center justify-center gap-2 text-sm",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[f.jsx(gs,{}),n.type==="subscribe"?"Successfully subscribed to calendar!":"Calendar file downloaded successfully!"]}),e&&f.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-6 bg-gradient-to-r from-amber-900/20 to-amber-800/20 border border-amber-500/30 text-amber-200 px-4 py-3 rounded-md text-center text-sm",children:f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx(nt,{}),f.jsx("span",{children:"Add medications to enable calendar export"})]})})]})}function Rt({icon:n,title:e,description:t,color:r}){const s=()=>{switch(r){case"blue":return"border-blue-500/10";case"purple":return"border-purple-500/10";case"green":return"border-green-500/10";default:return"border-gray-700"}},i=()=>{switch(r){case"blue":return"bg-blue-500/20";case"purple":return"bg-purple-500/20";case"green":return"bg-green-500/20";default:return"bg-gray-700"}},a=()=>{switch(r){case"blue":return"text-blue-300";case"purple":return"text-purple-300";case"green":return"text-green-300";default:return"text-white"}},o=()=>{switch(r){case"blue":return"text-blue-400";case"purple":return"text-purple-400";case"green":return"text-green-400";default:return"text-white"}};return f.jsxs(R.div,{className:`bg-[#1d1d1d]/60 p-5 rounded-lg border ${s()} flex flex-col items-center text-center`,whileHover:{y:-5},transition:{type:"spring",stiffness:300},children:[f.jsx("div",{className:`${i()} p-3 rounded-full mb-3`,children:f.jsx("div",{className:`text-xl ${o()}`,children:n})}),f.jsx("h3",{className:`text-sm font-medium mb-2 ${a()}`,children:e}),f.jsx("p",{className:"text-xs text-gray-400",children:t})]})}function Wo(){return f.jsxs("div",{className:"mt-12 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[f.jsx(Rt,{icon:f.jsx(st,{}),title:"Calendar Integration",description:"Works with Google Calendar, Apple Calendar, and Outlook",color:"blue"}),f.jsx(Rt,{icon:f.jsx(ys,{}),title:"Universal Format",description:"Standard .ics files compatible with all major calendar apps",color:"purple"}),f.jsx(Rt,{icon:f.jsx(vs,{}),title:"Stay on Schedule",description:"Receive reminders for every medication dose",color:"green"})]})}function Yo({medicines:n}){const[e,t]=D.useState({loading:!1,success:!1,type:null,error:null}),r=n.length===0,s=async()=>{if(!r){t({loading:!0,success:!1,type:"subscribe",error:null});try{await Bo(n),t({loading:!1,success:!0,type:"subscribe",error:null}),setTimeout(()=>{t(a=>({...a,success:!1}))},3e3)}catch(a){console.error("Error during subscribe process:",a),t({loading:!1,success:!1,type:"subscribe",error:"Could not subscribe to calendar. Please try again."}),setTimeout(()=>{t(o=>({...o,error:null}))},5e3)}}},i=async()=>{if(!r){t({loading:!0,success:!1,type:"download",error:null});try{await Vo(n),t({loading:!1,success:!0,type:"download",error:null}),setTimeout(()=>{t(a=>({...a,success:!1}))},3e3)}catch(a){console.error("Error during download process:",a),t({loading:!1,success:!1,type:"download",error:"Could not download calendar. Please try again."}),setTimeout(()=>{t(o=>({...o,error:null}))},5e3)}}};return f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("div",{className:"text-center max-w-2xl mx-auto mb-8",children:[f.jsx("p",{className:"text-gray-300 mb-3",children:"Export your medication schedule to your preferred calendar app to receive reminders and never miss a dose."}),f.jsx(Jo,{})]}),f.jsxs("div",{className:"max-w-3xl mx-auto w-full",children:[f.jsx(Go,{}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[f.jsx(bn,{icon:f.jsx(bs,{}),title:"Subscribe to Calendar",description:"Connect to your online calendar",onClick:s,isLoading:e.loading&&e.type==="subscribe",isDisabled:r,colorClass:"from-blue-700/90 to-blue-800/90 hover:from-blue-600 hover:to-blue-700 border-blue-600/30",iconBgClass:"bg-blue-400/30"}),f.jsx(bn,{icon:f.jsx(_s,{}),title:"Download Calendar",description:"Save as .ics file",onClick:i,isLoading:e.loading&&e.type==="download",isDisabled:r,colorClass:"from-purple-700/90 to-purple-800/90 hover:from-purple-600 hover:to-purple-700 border-purple-600/30",iconBgClass:"bg-purple-500/30"})]})]}),f.jsx(te,{children:f.jsx(Ko,{exportStatus:e,isDisabled:r})}),f.jsx(Wo,{})]})}function Dt({id:n,icon:e,title:t,color:r,children:s,delay:i=0}){const a={blue:"bg-blue-500/20 border-blue-500/10",purple:"bg-purple-500/20 border-purple-500/10",green:"bg-green-500/20 border-green-500/10"},o={blue:"text-blue-400",purple:"text-purple-400",green:"text-green-400"},l={blue:"bg-blue-500/5",purple:"bg-purple-500/5",green:"bg-green-500/5"};return f.jsxs(R.div,{id:n,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:i},className:"bg-gradient-to-br from-[#2a2a2a] to-[#252525] rounded-lg p-6 shadow-xl overflow-hidden relative",children:[f.jsx("div",{className:`absolute -top-16 -right-16 w-32 h-32 ${l[r]} rounded-full blur-xl`}),f.jsx("div",{className:`absolute -bottom-16 -left-16 w-32 h-32 ${l[r]} rounded-full blur-xl`}),f.jsxs("div",{className:"flex items-center mb-6 relative z-10",children:[f.jsx("div",{className:`${a[r]} p-3 rounded-full mr-4`,children:f.jsx("div",{className:`${o[r]} text-xl`,children:e})}),f.jsx("h2",{className:"text-2xl font-semibold",children:f.jsx("span",{className:`${o[r]}`,children:t})})]}),s]})}function Zo(){return f.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"mt-8 bg-gradient-to-br from-blue-900/20 to-purple-900/20 rounded-lg p-6 border border-blue-800/20",children:[f.jsxs("div",{className:"flex items-center mb-4",children:[f.jsx("div",{className:"bg-blue-500/20 p-2 rounded-full mr-3",children:f.jsx(nt,{className:"text-blue-400"})}),f.jsx("h3",{className:"text-xl font-semibold text-white",children:"How It Works"})]}),f.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[f.jsx(It,{number:1,color:"blue",title:"Add Your Medications",description:"Enter the name of your medication, the dosage, frequency, and period. You can add notes for specific instructions."}),f.jsx(It,{number:2,color:"purple",title:"Review Your Medications",description:"Check your list of medications. You can delete any entry that's no longer needed or add more medications to your schedule."}),f.jsx(It,{number:3,color:"green",title:"Export to Calendar",description:"Export your medication schedule to your preferred calendar app (iCal, Google, etc.) to receive reminders and keep track of your regimen."})]}),f.jsx("p",{className:"text-gray-400 text-sm mt-6 text-center",children:"Your medication data is stored locally on your device. We don't have access to your health information."})]})}function It({number:n,color:e,title:t,description:r}){const s={blue:"text-blue-300",purple:"text-purple-300",green:"text-green-300"};return f.jsxs("div",{className:"bg-[#1d1d1d]/60 p-4 rounded-lg border border-gray-800/30",children:[f.jsxs("h4",{className:`font-medium ${s[e]} mb-2`,children:["Step ",n,": ",t]}),f.jsx("p",{className:"text-gray-400 text-sm",children:r})]})}function il(){const[n,e]=D.useState(()=>{try{const s=localStorage.getItem("medicines");return s?JSON.parse(s):[]}catch{return[]}});D.useEffect(()=>{try{localStorage.setItem("medicines",JSON.stringify(n)),Ho()}catch(s){console.error("Error saving data:",s)}},[n]);const t=s=>{e(i=>[s,...i])},r=s=>{e(i=>i.filter((a,o)=>o!==s))};return f.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-b from-[#1e1e24] to-[#222222] text-white",children:[f.jsx(ws,{title:"Medicine Calendar - Track Your Medications",description:"Add your prescriptions, set frequencies, and export your calendar to stay on top of your health regimen.",keywords:"medicine tracker, medication schedule, medicine export, health management",ogTitle:"Medicine Calendar - Track Your Medications",ogDescription:"Never miss a dose again with our medication tracking calendar.",canonical:"https://juanmartin19l.github.io/medicine-calendar/"}),f.jsx(xs,{}),f.jsxs("div",{className:"flex-grow pt-24",children:[f.jsx(Ts,{title:"Your Personal Health Assistant",subtitle:"Track your medication schedule seamlessly. Add your prescriptions, set frequencies, and export your calendar to stay on top of your health regimen. Never miss a dose again."}),f.jsxs("div",{className:"max-w-6xl mx-auto px-4 mb-16",children:[f.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-16",children:[f.jsx(Dt,{id:"add-medication",icon:f.jsx(Me,{}),title:"Add New Medication",color:"blue",delay:.1,children:f.jsx(Cs,{onSubmit:t,existingMedicines:n})}),f.jsx(Dt,{id:"your-medications",icon:f.jsx(Ss,{}),title:"Your Medications",color:"purple",delay:.2,children:f.jsx(Fs,{medicines:n,onDelete:r})})]}),f.jsx(Dt,{id:"export-calendar",icon:f.jsx(st,{}),title:"Export Your Calendar",color:"green",delay:.3,children:f.jsx(Yo,{medicines:n})}),f.jsx(Zo,{})]})]}),f.jsx(Es,{})]})}export{il as default};
